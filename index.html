<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>NY Timer ‚Äî prototype</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@400;700;800&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<style>
  :root { --bg: #0a0a0a; --panel: rgba(255, 255, 255, 0.05); --text: #fff; --accent: #ff1744; }
  * { box-sizing: border-box; }
  
  body { 
    margin: 0; 
    font-family: 'Inter', sans-serif; 
    background: var(--bg); 
    color: var(--text); 
    overflow-x: hidden; 
    transition: background 0.5s ease;
  }

  /* –•–ï–î–ï–† */
  header { 
    position: fixed; top: 0; left: 0; width: 100%; height: 60px; 
    background: rgba(0,0,0,0.8); display: flex; align-items: center; 
    justify-content: space-between; padding: 0 20px; z-index: 100; backdrop-filter: blur(10px); 
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  .brand { font-weight: 800; font-family: 'Orbitron', sans-serif; font-size: 18px; color: var(--accent); }
  
  .nav-group { display: flex; gap: 10px; align-items: center; }
  .btn-ui { 
    padding: 8px 14px; border-radius: 8px; border: none; cursor: pointer; 
    font-weight: 600; color: white; transition: 0.3s; background: rgba(255,255,255,0.1); 
    font-size: 13px;
  }
  .btn-ui:hover { background: rgba(255,255,255,0.2); }
  .btn-edit { background: #ff9800; box-shadow: 0 0 15px rgba(255, 152, 0, 0.2); }

  /* –ì–õ–ê–í–ù–´–ô –ö–û–ù–¢–ï–ù–¢ (–° –≠–§–§–ï–ö–¢–û–ú –û–¢–î–ê–õ–ï–ù–ò–Ø) */
  main { 
    padding-top: 80px; padding-bottom: 100px;
    transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); 
    transform-origin: center top; min-height: 100vh; 
  }
  
  body.edit-mode-active main { 
    transform: scale(0.65) translateY(40px); opacity: 0.3; filter: blur(2px); pointer-events: none; 
  }

  /* –¢–ê–ô–ú–ï–† */
  #timer { 
    font-size: clamp(40px, 12vw, 100px); text-align: center; 
    margin: 30px 0; font-weight: 900; position: relative; z-index: 10; 
    transition: all 0.5s ease;
  }

  /* –ö–ê–õ–ï–ù–î–ê–†–¨ */
  .calendar { 
    display: grid; grid-template-columns: repeat(4, 1fr); 
    gap: 12px; max-width: 800px; margin: 40px auto; padding: 0 20px; 
  }
  .day { 
    background: #191919; padding: 25px 10px; border-radius: 12px; 
    text-align: center; cursor: pointer; border: 1px solid #333; 
    font-weight: 700; transition: 0.2s;
  }
  .day.opened { background: #1a3a1a; border-color: #2d5; color: #2d5; position: relative; }
  .day.opened::after { content: '‚úì'; position: absolute; top: 5px; right: 8px; font-size: 12px; }
  .day.locked { opacity: 0.3; cursor: not-allowed; filter: grayscale(1); }

  /* –ü–ê–ù–ï–õ–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø */
  .menu { 
    position: fixed; top: 0; left: -300px; width: 280px; height: 100%; 
    background: #111; z-index: 1000; transition: 0.4s; padding: 80px 20px; 
    border-right: 1px solid #333; box-shadow: 20px 0 50px rgba(0,0,0,0.5);
    overflow-y: auto; /* –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 1: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–ª—è –¥–ª–∏–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ —Å–∫–∏–Ω–æ–≤ */
  }
  .menu.open { left: 0; }
  .menu h2 { 
    margin-top: 0; 
    position: sticky; /* –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 1: –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Å—Ç–∞–µ—Ç—Å—è –≤–∏–¥–∏–º—ã–º –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ */
    top: 0;
    background: #111;
    padding: 10px 0;
    z-index: 1;
  }
  .menu button { 
    width: 100%; padding: 12px; margin-bottom: 10px; border: none; 
    border-radius: 8px; background: #222; color: white; text-align: left; 
    cursor: pointer; font-weight: 600; 
  }

  /* –ü–ê–ù–ï–õ–¨ –£–ö–†–ê–®–ï–ù–ò–ô */
.decoration-panel { 
    position: fixed;
    bottom: -100%; /* –í–ê–ñ–ù–û: –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ó–ê —ç–∫—Ä–∞–Ω–æ–º —Å–Ω–∏–∑—É */
    left: 50%; 
    transform: translateX(-50%);
    width: 95%; 
    max-width: 500px; 
    max-height: 80vh;
    background: rgba(15, 15, 15, 0.98); 
    padding: 25px; 
    padding-bottom: calc(25px + env(safe-area-inset-bottom));
    border-radius: 20px 20px 0 0; 
    z-index: 2000; 
    transition: bottom 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border: 1px solid #444;
    overflow-y: auto;
    overflow-x: hidden;
}

.decoration-panel.active { 
    bottom: 0 !important; /* –í—ã–µ–∑–∂–∞–µ—Ç –≤–≤–µ—Ä—Ö –∫ –Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞ */
}

/* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –±—ã–ª–∏ */
.decoration-panel::-webkit-scrollbar {
    width: 6px;
}

.decoration-panel::-webkit-scrollbar-track {
    background: rgba(255,255,255,0.05);
    border-radius: 3px;
}

.decoration-panel::-webkit-scrollbar-thumb {
    background: rgba(255,255,255,0.2);
    border-radius: 3px;
}

.decoration-panel::-webkit-scrollbar-thumb:hover {
    background: rgba(255,255,255,0.3);
}

  /* –§–£–¢–ï–† */
/* –§–£–¢–ï–† - –ò–°–ü–†–ê–í–õ–ï–ù–û */
/* –§–£–¢–ï–† - –ü–†–ê–í–ò–õ–¨–ù–´–ï –°–¢–ò–õ–ò */
footer {
    position: fixed !important; 
    bottom: 0 !important; 
    left: 0 !important;
    width: 100%; 
    height: calc(40px + env(safe-area-inset-bottom));
    background: rgba(0,0,0,0.7); 
    display: flex; 
    align-items: center; 
    justify-content: center;
    font-size: 12px; 
    color: #666; 
    z-index: 90; 
    padding-bottom: env(safe-area-inset-bottom);
    overflow: hidden; /* –ü—Ä—è—á–µ–º –≤—ã—Ö–æ–¥—è—â–∏–π —Ç–µ–∫—Å—Ç */
}

#footer-text {
    transition: opacity 0.5s ease;
    white-space: nowrap;
    opacity: 1;
    text-align: center;
    padding: 0 20px;
}

/* –ü–ê–ù–ï–õ–¨ –£–ö–†–ê–®–ï–ù–ò–ô - –ò–°–ü–†–ê–í–õ–ï–ù–û */
.decoration-panel { 
    position: fixed !important;
    bottom: 0 !important; /* –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–Ω–∏–∑—É –≤ —Å–∫—Ä—ã—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ */
    left: 50%; 
    transform: translateX(-50%) translateY(100%); /* –í–ê–ñ–ù–û: –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–ø—Ä—è—Ç–∞–Ω–∞ –≤–Ω–∏–∑—É */
    width: 95%; 
    max-width: 500px; 
    max-height: 80vh;
    background: rgba(15, 15, 15, 0.98); 
    padding: 25px; 
    padding-bottom: calc(25px + env(safe-area-inset-bottom)); /* –û—Ç—Å—Ç—É–ø –¥–ª—è iPhone */
    border-radius: 20px 20px 0 0; 
    z-index: 2000; 
    transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border: 1px solid #444;
    overflow-y: auto;
    overflow-x: hidden;
}

.decoration-panel.active { 
    transform: translateX(-50%) translateY(0) !important; /* –í—ã–µ–∑–∂–∞–µ—Ç –≤–≤–µ—Ä—Ö */
}

/* –°–∫—Ä—ã–≤–∞–µ–º —Å–∫—Ä–æ–ª–ª–±–∞—Ä –Ω–æ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª */
.decoration-panel::-webkit-scrollbar {
    width: 6px;
}

.decoration-panel::-webkit-scrollbar-track {
    background: rgba(255,255,255,0.05);
    border-radius: 3px;
}

.decoration-panel::-webkit-scrollbar-thumb {
    background: rgba(255,255,255,0.2);
    border-radius: 3px;
}

.decoration-panel::-webkit-scrollbar-thumb:hover {
    background: rgba(255,255,255,0.3);
}

/* –°–µ–∫—Ü–∏–∏ —É–∫—Ä–∞—à–µ–Ω–∏–π */
.decor-section {
    margin-bottom: 20px;
    padding: 15px;
    background: rgba(255,255,255,0.03);
    border-radius: 12px;
}

.decor-section h4 {
    margin: 0 0 15px 0;
    color: #ffd700;
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.decor-slot {
    margin-bottom: 15px;
}

.decor-slot.completed {
    opacity: 0.6;
}

.decor-slot.completed .progress-fill {
    background: linear-gradient(90deg, #4caf50, #8bc34a) !important;
}

.decor-slot.completed button {
    background: #4caf50 !important;
    cursor: not-allowed;
    opacity: 0.7;
}

/* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–∫—Ä–∞—à–µ–Ω–∏–π */

/* –°–Ω–µ–∂–∏–Ω–∫–∏ –≤ —É–≥–ª–∞—Ö —ç–∫—Ä–∞–Ω–∞ */
.corner-snow {
    position: fixed;
    font-size: 30px;
    pointer-events: none;
    z-index: 95;
    animation: cornerFloat 3s ease-in-out infinite;
}

@keyframes cornerFloat {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    50% { transform: translateY(-10px) rotate(180deg); }
}

/* –ì–∏—Ä–ª—è–Ω–¥–∞ –Ω–∞ —Ö–µ–¥–µ—Ä–µ */
.header-garland {
    position: absolute;
    bottom: -5px;
    left: 0;
    width: 100%;
    height: 8px;
    background: repeating-linear-gradient(
        90deg,
        #ff0000 0px, #ff0000 20px,
        #00ff00 20px, #00ff00 40px,
        #0000ff 40px, #0000ff 60px,
        #ffff00 60px, #ffff00 80px
    );
    animation: garlandSlide 2s linear infinite;
    opacity: 0.6;
}

@keyframes garlandSlide {
    0% { background-position: 0 0; }
    100% { background-position: 80px 0; }
}

/* –°–≤–µ—Ç—è—â–∏–µ—Å—è –∑–≤–µ–∑–¥—ã –ø–æ –±–æ–∫–∞–º */
.side-star {
    position: fixed;
    font-size: 40px;
    pointer-events: none;
    z-index: 95;
    animation: starTwinkle 2s ease-in-out infinite;
}

@keyframes starTwinkle {
    0%, 100% { opacity: 0.3; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.2); }
}

/* –†–∞–º–∫–∞ –≤–æ–∫—Ä—É–≥ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
.festive-border {
    position: fixed;
    pointer-events: none;
    z-index: 1;
}

.festive-border.top {
    top: 60px;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, #ff0000, #00ff00, #0000ff, #ffff00, #ff00ff);
    animation: borderShine 3s linear infinite;
}

.festive-border.bottom {
    bottom: 40px;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, #ff00ff, #ffff00, #0000ff, #00ff00, #ff0000);
    animation: borderShine 3s linear infinite;
}

@keyframes borderShine {
    0% { opacity: 0.5; }
    50% { opacity: 1; }
    100% { opacity: 0.5; }
}

/* –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ –Ω–∞ —Ñ–æ–Ω–µ */
.ambient-confetti {
    position: fixed;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    pointer-events: none;
    z-index: 5;
    animation: ambientFloat 20s linear infinite;
}

@keyframes ambientFloat {
    0% { transform: translateY(-10vh) translateX(0) rotate(0deg); opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { transform: translateY(110vh) translateX(50px) rotate(720deg); opacity: 0; }
}

/* –ú–∏–≥–∞—é—â–∏–µ –æ–≥–æ–Ω—å–∫–∏ –ø–æ –±–æ–∫–∞–º */
.side-light {
    position: fixed;
    width: 15px;
    height: 15px;
    border-radius: 50%;
    pointer-events: none;
    z-index: 95;
    animation: lightBlink 1s ease-in-out infinite;
}

@keyframes lightBlink {
    0%, 100% { opacity: 0.3; box-shadow: 0 0 5px currentColor; }
    50% { opacity: 1; box-shadow: 0 0 20px currentColor; }
}

/* –°–Ω–µ–≥–æ–ø–∞–¥ –Ω–∞ —Ç–∞–π–º–µ—Ä–µ */
.timer-snow-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
}

.timer-snow-particle {
    position: absolute;
    color: rgba(255, 255, 255, 0.8);
    font-size: 12px;
    animation: timerSnowFall 3s linear infinite;
}

@keyframes timerSnowFall {
    0% { transform: translateY(-20px); opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { transform: translateY(100px); opacity: 0; }
}

  /* --- –¢–ï–ú–´ (–°–ö–ò–ù–´) --- */
  
  /* NEON */
  #timer.neon { color: #0ff; text-shadow: 0 0 20px #0ff, 0 0 40px #0ff; }
  
  /* MINECRAFT */
  body.minecraft-skin { background: #5d3a1a; }
  #timer.mc-style { 
    background: #c6c6c6; border: 4px solid #000; color: #3f3f3f; 
    box-shadow: inset -4px -4px #555, inset 4px 4px #fff; border-radius: 0; 
  }

  /* DEMON SLAYER */
  #timer.demonslayer-style { 
    color: #fff; text-shadow: 0 0 15px #ff1744, 0 0 30px #ff1744; 
    border-left: 5px solid #ff1744; border-right: 5px solid #ff1744; padding: 10px 30px;
  }

  /* GALAXY */
  #timer.galaxy-style { 
    color: #f0f; border: 2px double #f0f; border-radius: 50px; 
    box-shadow: 0 0 20px rgba(255,0,255,0.3); 
  }

  /* –≠–§–§–ï–ö–¢–´ - –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 2: –≤ —Ä–µ–∂–∏–º–µ —É–∫—Ä–∞—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç—ã —É—Ö–æ–¥—è—Ç –Ω–∞ –∑–∞–¥–Ω–∏–π –ø–ª–∞–Ω */
  .fx { 
    position: fixed; 
    pointer-events: none; 
    z-index: 15; 
    transition: opacity 0.6s ease, filter 0.6s ease, transform 0.6s ease; 
  }
  
  body.edit-mode-active .fx {
    opacity: 0.2 !important;
    filter: blur(3px);
    transform: scale(0.95);
    z-index: 5 !important;
  }
  
  @keyframes fxFall { to { transform: translateY(110vh) rotate(360deg); opacity: 0; } }

  /* –ú–û–î–ê–õ–ö–ê */
  #name-modal { 
    position: fixed; inset: 0; background: rgba(0,0,0,0.9); 
    z-index: 10000; display: flex; align-items: center; justify-content: center; 
  }
  .modal-box { background: #1a1a1a; padding: 30px; border-radius: 15px; text-align: center; border: 1px solid #444; width: 320px; }
  .modal-box input { width: 100%; padding: 12px; margin: 15px 0; border-radius: 8px; border: 1px solid #444; background: #000; color: white; }

  /* –ê–Ω–∏–º–∞—Ü–∏—è –º–∏–≥–∞–Ω–∏—è –≥–∏—Ä–ª—è–Ω–¥—ã */
@keyframes blink {
    from { opacity: 0.3; transform: scale(0.8); }
    to { opacity: 1; transform: scale(1.1); }
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Å–Ω–µ–∂–∏–Ω–æ–∫ */
.fx.snow {
    position: fixed;
    color: white;
    user-select: none;
    pointer-events: none;
    z-index: 1000;
    text-shadow: 0 0 5px rgba(255,255,255,0.8);
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –ø–∞–¥–µ–Ω–∏—è —Å–Ω–µ–≥–∞ */
@keyframes snowFall {
    0% { transform: translateY(-10vh) translateX(0); }
    100% { transform: translateY(110vh) translateX(20px); }
}

/* –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 4: –ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–ª–µ–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç—É—Å –≤–∫–ª/–≤—ã–∫–ª */
.music-player {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    background: rgba(255,255,255,0.05);
    padding: 10px 20px;
    border-radius: 30px;
    transition: all 0.3s ease;
}

.kookoo-music {
    text-align: center;
    margin: 20px 0;
    display: flex;
    justify-content: center;
    align-items: center;
}

.kookoo-music .music-player {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    background: rgba(255,255,255,0.05);
    padding: 10px 20px;
    border-radius: 30px;
    transition: all 0.3s ease;
}

.kookoo-music .music-player:hover {
    background: rgba(255,255,255,0.1);
}

.music-player:hover {
    background: rgba(255,255,255,0.1);
}

.music-player.playing .music-icon {
    animation: pulse 1s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
}

/* NEON - –Ø—Ä–∫–æ-–≥–æ–ª—É–±–æ–π –Ω–µ–æ–Ω */
#timer.neon { 
    color: #00ffff; 
    text-shadow: 0 0 20px #00ffff, 0 0 40px #0ff, 0 0 60px #0ff;
    animation: neonPulse 2s ease-in-out infinite;
}

@keyframes neonPulse {
    0%, 100% { text-shadow: 0 0 20px #00ffff, 0 0 40px #0ff, 0 0 60px #0ff; }
    50% { text-shadow: 0 0 30px #00ffff, 0 0 60px #0ff, 0 0 90px #0ff; }
}

/* PIXEL - –ó–µ–ª–µ–Ω—ã–π –º–∞—Ç—Ä–∏—á–Ω—ã–π */
#timer.pixel {
    color: #00ff00;
    text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00;
    font-family: 'Courier New', monospace;
}

/* STARFIELD - –ë–µ–ª—ã–π –∫–æ—Å–º–∏—á–µ—Å–∫–∏–π —Å –∑–≤–µ–∑–¥–Ω—ã–º —Å–≤–µ—á–µ–Ω–∏–µ–º */
#timer.starfield-style {
    color: #ffffff;
    text-shadow: 0 0 15px #4af, 0 0 30px #48f, 0 0 45px #26d;
}

/* GALAXY - –ü—É—Ä–ø—É—Ä–Ω—ã–π –≥–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π */
#timer.galaxy-style { 
    color: #ff00ff;
    background: linear-gradient(45deg, #ff00ff, #00ffff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    border: 2px double #f0f; 
    border-radius: 50px; 
    box-shadow: 0 0 30px rgba(255,0,255,0.5), inset 0 0 20px rgba(255,0,255,0.2);
    padding: 20px 40px;
}

/* SORROW - –°–µ—Ä–æ-–≥–æ–ª—É–±–æ–π –¥–æ–∂–¥–ª–∏–≤—ã–π */
#timer.sorrow-style {
    color: #aec2e0;
    text-shadow: 0 0 10px #6a8caf, 0 2px 4px rgba(0,0,0,0.5);
    opacity: 0.9;
}

/* FIRESTORM - –û—Ä–∞–Ω–∂–µ–≤–æ-–∫—Ä–∞—Å–Ω—ã–π –æ–≥–Ω–µ–Ω–Ω—ã–π */
#timer.firestorm-active {
    color: #ff4d00 !important;
    text-shadow: 0 0 20px #ff0000, 0 0 40px #ff6600, 0 0 60px #ffae00;
    animation: fireShake 0.1s infinite, fireGlow 1.5s ease-in-out infinite;
}

@keyframes fireGlow {
    0%, 100% { text-shadow: 0 0 20px #ff0000, 0 0 40px #ff6600, 0 0 60px #ffae00; }
    50% { text-shadow: 0 0 30px #ff0000, 0 0 60px #ff6600, 0 0 90px #ffae00; }
}

@keyframes fireShake {
    0% { transform: translate(1px, 1px); }
    50% { transform: translate(-1px, -2px); }
    100% { transform: translate(1px, 1px); }
}

/* MINECRAFT - –ü–∏–∫—Å–µ–ª—å–Ω—ã–π –º–∞–π–Ω–∫—Ä–∞—Ñ—Ç —Å—Ç–∏–ª—å */
#timer.mc-style { 
    background: #c6c6c6; 
    border: 4px solid #000; 
    color: #3f3f3f; 
    box-shadow: inset -4px -4px #555, inset 4px 4px #fff; 
    border-radius: 0; 
    padding: 20px 40px;
    font-family: 'Courier New', monospace;
}

/* DEMON SLAYER - –ö—Ä–∞—Å–Ω—ã–π —Å —è–ø–æ–Ω—Å–∫–∏–º —Å—Ç–∏–ª–µ–º */
#timer.demonslayer-style { 
    color: #ff1744; 
    text-shadow: 0 0 15px #ff1744, 0 0 30px #ff1744, 0 0 45px #c51162; 
    border-left: 5px solid #ff1744; 
    border-right: 5px solid #ff1744; 
    padding: 10px 30px;
    position: relative;
}

#timer.demonslayer-style::before,
#timer.demonslayer-style::after {
    content: '‚öî';
    position: absolute;
    font-size: 0.4em;
    opacity: 0.6;
}

#timer.demonslayer-style::before { left: 10px; }
#timer.demonslayer-style::after { right: 10px; }

#kookoo-wrapper {
    position: relative;
    width: 100%;
    max-width: 400px;
    margin: 0 auto;
    padding: 20px;
    z-index: 50;
}

.kookoo-content {
    position: relative;
    width: 100%;
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
}

.kookoo-gif {
    position: relative;
    width: 100%;
    height: auto;
    z-index: 2;
}

.kookoo-timer {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: clamp(32px, 6vw, 64px);
    font-weight: 900;
    font-family: 'Orbitron', sans-serif;
    color: #ff00ff;
    text-shadow: 0 0 20px #ff00ff, 0 0 40px #ff00ff, 0 0 60px #ff00ff;
    z-index: 3;
    white-space: nowrap;
    pointer-events: none;
}
/* –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 4: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ç—Ä–µ–∫–∞ –∏ –¥–∏—Å–∫–æ–º */
.music-notice {
    position: fixed;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 12px 20px;
    border-radius: 50px;
    display: flex;
    align-items: center;
    gap: 15px;
    z-index: 10000;
    opacity: 0;
    pointer-events: none;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}

.music-notice.active {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
}

.disc-wrapper {
    font-size: 24px;
    animation: spin 3s linear infinite;
}

/* –≠—Ñ—Ñ–µ–∫—Ç –∂–∞—Ä–∞ –¥–ª—è Firestorm */
.firestorm-overlay {
    position: fixed;
    inset: 0;
    background: url('data:image/svg+xml,<svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><filter id="w"><feTurbulence type="fractalNoise" baseFrequency="0.015" numOctaves="2" /></filter><rect width="100%" height="100%" filter="url(%23w)" opacity="0.2"/></svg>');
    mix-blend-mode: overlay;
    pointer-events: none;
    animation: heatWave 2s linear infinite;
}

@keyframes heatWave {
    from { transform: scale(1); }
    50% { transform: scale(1.05); }
    to { transform: scale(1); }
}

.firestorm-active {
    color: #ff4d00 !important;
    text-shadow: 0 0 20px #ff0000, 0 0 40px #ffae00;
    animation: shake 0.1s infinite;
}

@keyframes shake {
    0% { transform: translate(1px, 1px); }
    50% { transform: translate(-1px, -2px); }
    100% { transform: translate(1px, 1px); }
}

.track-label {
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: #aaa;
}

.track-title {
    font-weight: bold;
    color: #fff;
    white-space: nowrap;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* –ï–ª–∫–∞ –≤ —Ö–µ–¥–µ—Ä–µ */
.header-tree {
    font-size: 24px;
    animation: treeGlow 2s ease-in-out infinite;
    user-select: none;
}

@keyframes treeGlow {
    0%, 100% { filter: brightness(1); }
    50% { filter: brightness(1.3); }
}

/* –ì–∏—Ä–ª—è–Ω–¥—ã –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ */
.day.has-garland {
    position: relative;
    border-color: #ffd700 !important;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
}

.day.has-garland::before {
    content: '‚ú®üí°‚ú®';
    position: absolute;
    top: -10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 10px;
    animation: garlandBlink 1s infinite;
}

@keyframes garlandBlink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

/* –°–Ω–µ–∂–∏–Ω–∫–∏ –Ω–∞ —Ñ–æ–Ω–µ */
.permanent-snow {
    position: fixed;
    color: white;
    font-size: 20px;
    pointer-events: none;
    z-index: 5;
    animation: snowDrift 15s linear infinite;
    text-shadow: 0 0 5px rgba(255,255,255,0.8);
}

@keyframes snowDrift {
    0% { transform: translateY(-10vh) translateX(0) rotate(0deg); }
    100% { transform: translateY(110vh) translateX(50px) rotate(360deg); }
}

/* –°–∞–ª—é—Ç */
.firework-burst {
    position: fixed;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    pointer-events: none;
    z-index: 9998;
}

/* –ü–æ–¥–∞—Ä–∫–∏ */
.gift-rain {
    position: fixed;
    font-size: 30px;
    pointer-events: none;
    z-index: 9998;
    animation: giftFall 3s linear;
}

@keyframes giftFall {
    0% { transform: translateY(-50px) rotate(0deg); opacity: 1; }
    100% { transform: translateY(110vh) rotate(360deg); opacity: 0.5; }
}

/* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–µ–π—Å—Ç–≤–∏–∏ */
.action-notice {
    position: fixed;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: rgba(76, 175, 80, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    padding: 15px 25px;
    border-radius: 50px;
    z-index: 10000;
    opacity: 0;
    pointer-events: none;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    color: white;
    font-weight: bold;
    font-size: 14px;
}

.action-notice.active {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
}

/* –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å —É–∫—Ä–∞—à–µ–Ω–∏–π */
.decoration-panel {
    max-height: 80vh;
    overflow-y: auto;
}

.decor-section {
    margin-bottom: 20px;
    padding: 15px;
    background: rgba(255,255,255,0.03);
    border-radius: 12px;
}

.decor-section h4 {
    margin: 0 0 10px 0;
    color: #ffd700;
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.decor-slot {
    margin-bottom: 15px;
}

.decor-slot.completed .progress-fill {
    background: linear-gradient(90deg, #4caf50, #8bc34a) !important;
}

.decor-slot.completed button {
    background: #4caf50 !important;
    cursor: not-allowed;
}

.progress-bg { 
    background: #222; 
    height: 12px; 
    border-radius: 6px; 
    overflow: hidden; 
    margin: 10px 0; 
    border: 1px solid #333;
    width: 100%; /* –í–ê–ñ–ù–û: —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º —à–∏—Ä–∏–Ω—É */
    position: relative; /* –í–ê–ñ–ù–û: –¥–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ª–∏–≤–∫–∏ */
}

.progress-fill { 
    height: 100%; 
    width: 0%; /* –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0 */
    transition: width 0.4s ease; /* –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è */
    position: relative;
    border-radius: 6px;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤ —Å–ª–æ—Ç–∞—Ö */
.decor-slot {
    margin-bottom: 15px;
}

.decor-slot button {
    margin-top: 10px;
}

.decor-slot.completed {
    opacity: 0.7;
}

.decor-slot.completed .progress-fill {
    background: linear-gradient(90deg, #4caf50, #8bc34a) !important;
}

.decor-slot.completed button {
    background: #666 !important;
    cursor: not-allowed;
    pointer-events: none;
}
</style>
</head>

<body>

<div id="name-modal">
    <div class="modal-box">
        <h3 style="margin-top:0">–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?</h3>
        <input type="text" id="user-name-input" placeholder="–¢–≤–æ–µ –∏–º—è...">
        <button class="btn-ui btn-edit" style="width:100%" onclick="saveName(event)">–í–æ–π—Ç–∏ –≤ 2026</button>
        <p style="font-size:11px; color:#666; margin-top:10px">–¢–≤–æ—ë –∏–º—è —É–≤–∏–¥—è—Ç –¥—Ä—É–≥–∏–µ –≤ —Å–ø–∏—Å–∫–µ –æ–Ω–ª–∞–π–Ω</p>
    </div>
</div>

<header>
    <div class="brand">NY 2026</div>
    <div id="online-list" style="font-size: 12px; color: #4caf50;"></div>
    <div class="nav-group">
        <button class="btn-ui" onclick="toggleMenu()">‚ò∞ –°–∫–∏–Ω—ã</button>
        <button class="btn-ui btn-edit" onclick="toggleEditMode()">‚ú® –£–∫—Ä–∞—Å–∏—Ç—å</button>
    </div>
</header>

<div class="menu" id="menu">
    <h2>–í—ã–±–µ—Ä–∏ —Å—Ç–∏–ª—å</h2>
    <button onclick="setSkin('default')">üéÑ Default</button>
    <button onclick="setSkin('Kookoo')">üïê Grace - kookoo</button>
    <button onclick="setSkin('neon')">‚ö° Neon glow</button>
    <button onclick="setSkin('pixel')">üéÆ Pixel</button>
    <button onclick="setSkin('starfield')">‚≠ê Starfield</button>
    <button onclick="setSkin('galaxy')">üåå Galaxy</button>
    <button onclick="setSkin('sorrow')">üåßÔ∏è Sorrow</button>
    <button onclick="setSkin('fire')">üî• Firestorm</button>
    <button onclick="setSkin('minecraft')">‚õèÔ∏è Minecraft</button>
    <button onclick="setSkin('demonslayer')">‚öîÔ∏è Demon Slayer</button>

    <button onclick="toggleMenu()" style="background:#444; margin-top:20px; text-align:center">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>

<main id="main-content-wrapper">
    <div id="timer">00:00:00</div>
    
    <!-- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 4: –ü–ª–µ–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç—É—Å -->
    <div style="text-align:center; margin-bottom: 20px;">
        <div class="music-player" onclick="toggleMusic()">
            <span class="music-icon">üéµ</span>
            <span id="music-status">–ú—É–∑—ã–∫–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞</span>
        </div>
    </div>

    <div id="calendar" class="calendar"></div>
</main>
<div id="decoration-panel" class="decoration-panel">
    <h3 style="text-align: center; margin-top: 0;">üõ† –†–µ–∂–∏–º —É–∫—Ä–∞—à–µ–Ω–∏—è</h3>
    <p style="font-size:13px; color:#aaa; text-align:center">–£–ª—É—á—à–∞–π—Ç–µ —Å–∞–π—Ç –≤–º–µ—Å—Ç–µ!</p>
    
    <!-- –ü–∞—Å—Å–∏–≤–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è -->
    <div class="decor-section">
        <h4>üéÑ –ü–∞—Å—Å–∏–≤–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è</h4>
        
        <div class="decor-slot" id="slot-tree">
            <div style="display:flex; justify-content:space-between; font-size:14px">
                <span>üéÑ –ï–ª–∫–∞ –≤ —Ö–µ–¥–µ—Ä–µ</span>
                <span id="tree-count">0/100</span>
            </div>
            <div class="progress-bg">
                <div id="bar-tree" class="progress-fill" style="background: #4caf50;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:12px" onclick="clickDecor('tree')">–î–û–ë–ê–í–ò–¢–¨!</button>
        </div>

        <div class="decor-slot" id="slot-garland">
            <div style="display:flex; justify-content:space-between; font-size:14px">
                <span>üí° –ì–∏—Ä–ª—è–Ω–¥—ã –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ</span>
                <span id="garland-count">0/150</span>
            </div>
            <div class="progress-bg">
                <div id="bar-garland" class="progress-fill" style="background: #ffd700;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:12px" onclick="clickDecor('garland')">–£–ö–†–ê–°–ò–¢–¨!</button>
        </div>

        <div class="decor-slot" id="slot-snow">
            <div style="display:flex; justify-content:space-between; font-size:14px">
                <span>‚ùÑÔ∏è –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Å–Ω–µ–≥</span>
                <span id="snow-count">0/200</span>
            </div>
            <div class="progress-bg">
                <div id="bar-snow" class="progress-fill" style="background: #00bcd4;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:12px" onclick="clickDecor('snow')">–ó–ê–ü–£–°–¢–ò–¢–¨!</button>
        </div>

        <div class="decor-slot" id="slot-corners">
            <div style="display:flex; justify-content:space-between; font-size:14px">
                <span>‚ùÑÔ∏è –°–Ω–µ–∂–∏–Ω–∫–∏ –≤ —É–≥–ª–∞—Ö</span>
                <span id="corners-count">0/120</span>
            </div>
            <div class="progress-bg">
                <div id="bar-corners" class="progress-fill" style="background: #b3e5fc;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:12px" onclick="clickDecor('corners')">–£–ö–†–ê–°–ò–¢–¨!</button>
        </div>

        <div class="decor-slot" id="slot-header-garland">
            <div style="display:flex; justify-content:space-between; font-size:14px">
                <span>üéÄ –ì–∏—Ä–ª—è–Ω–¥–∞ –Ω–∞ —Ö–µ–¥–µ—Ä</span>
                <span id="header-garland-count">0/180</span>
            </div>
            <div class="progress-bg">
                <div id="bar-header-garland" class="progress-fill" style="background: #ff9800;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:12px" onclick="clickDecor('header-garland')">–ü–û–í–ï–°–ò–¢–¨!</button>
        </div>

        <div class="decor-slot" id="slot-stars">
            <div style="display:flex; justify-content:space-between; font-size:14px">
                <span>‚≠ê –ó–≤–µ–∑–¥—ã –ø–æ –±–æ–∫–∞–º</span>
                <span id="stars-count">0/140</span>
            </div>
            <div class="progress-bg">
                <div id="bar-stars" class="progress-fill" style="background: #ffeb3b;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:12px" onclick="clickDecor('stars')">–ó–ê–ñ–ï–ß–¨!</button>
        </div>

        <div class="decor-slot" id="slot-border">
            <div style="display:flex; justify-content:space-between; font-size:14px">
                <span>üåà –ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è —Ä–∞–º–∫–∞</span>
                <span id="border-count">0/160</span>
            </div>
            <div class="progress-bg">
                <div id="bar-border" class="progress-fill" style="background: #9c27b0;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:12px" onclick="clickDecor('border')">–°–û–ó–î–ê–¢–¨!</button>
        </div>

        <div class="decor-slot" id="slot-ambient-confetti">
            <div style="display:flex; justify-content:space-between; font-size:14px">
                <span>üéä –§–æ–Ω–æ–≤–æ–µ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏</span>
                <span id="ambient-confetti-count">0/220</span>
            </div>
            <div class="progress-bg">
                <div id="bar-ambient-confetti" class="progress-fill" style="background: #e91e63;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:12px" onclick="clickDecor('ambient-confetti')">–ó–ê–ü–£–°–¢–ò–¢–¨!</button>
        </div>

        <div class="decor-slot" id="slot-side-lights">
            <div style="display:flex; justify-content:space-between; font-size:14px">
                <span>üí° –û–≥–æ–Ω—å–∫–∏ –ø–æ –±–æ–∫–∞–º</span>
                <span id="side-lights-count">0/190</span>
            </div>
            <div class="progress-bg">
                <div id="bar-side-lights" class="progress-fill" style="background: #ff5722;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:12px" onclick="clickDecor('side-lights')">–í–ö–õ–Æ–ß–ò–¢–¨!</button>
        </div>

        <div class="decor-slot" id="slot-timer-snow">
            <div style="display:flex; justify-content:space-between; font-size:14px">
                <span>‚ùÑÔ∏è –°–Ω–µ–≥ –Ω–∞ —Ç–∞–π–º–µ—Ä–µ</span>
                <span id="timer-snow-count">0/170</span>
            </div>
            <div class="progress-bg">
                <div id="bar-timer-snow" class="progress-fill" style="background: #03a9f4;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:12px" onclick="clickDecor('timer-snow')">–î–û–ë–ê–í–ò–¢–¨!</button>
        </div>
    </div>

    <!-- –ú–Ω–æ–≥–æ—Ä–∞–∑–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã -->
    <div class="decor-section">
        <h4>‚ú® –ú–Ω–æ–≥–æ—Ä–∞–∑–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</h4>
        
        <div class="decor-slot">
            <div style="display:flex; justify-content:space-between; font-size:14px; margin-bottom:8px">
                <span>üéÜ –°–∞–ª—é—Ç</span>
                <span id="firework-ready">0/30</span>
            </div>
            <div class="progress-bg">
                <div id="bar-firework-ready" class="progress-fill" style="background: #ff5722;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:15px; background:#ff5722; font-size:16px; margin-top:8px" onclick="clickMultiUse('firework')">–ó–ê–†–Ø–î–ò–¢–¨!</button>
        </div>

        <div class="decor-slot">
            <div style="display:flex; justify-content:space-between; font-size:14px; margin-bottom:8px">
                <span>üéÅ –î–æ–∂–¥—å –∏–∑ –ø–æ–¥–∞—Ä–∫–æ–≤</span>
                <span id="gifts-ready">0/25</span>
            </div>
            <div class="progress-bg">
                <div id="bar-gifts-ready" class="progress-fill" style="background: #e91e63;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:15px; background:#e91e63; font-size:16px; margin-top:8px" onclick="clickMultiUse('gifts')">–°–û–ë–†–ê–¢–¨!</button>
        </div>

        <div class="decor-slot">
            <div style="display:flex; justify-content:space-between; font-size:14px; margin-bottom:8px">
                <span>üéâ –ö–æ–Ω—Ñ–µ—Ç—Ç–∏</span>
                <span id="confetti-ready">0/20</span>
            </div>
            <div class="progress-bg">
                <div id="bar-confetti-ready" class="progress-fill" style="background: #9c27b0;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:15px; background:#9c27b0; font-size:16px; margin-top:8px" onclick="clickMultiUse('confetti')">–ü–û–î–ì–û–¢–û–í–ò–¢–¨!</button>
        </div>

        <div class="decor-slot">
            <div style="display:flex; justify-content:space-between; font-size:14px; margin-bottom:8px">
                <span>‚ö° –ú–æ–ª–Ω–∏–∏</span>
                <span id="lightning-ready">0/35</span>
            </div>
            <div class="progress-bg">
                <div id="bar-lightning-ready" class="progress-fill" style="background: #ffeb3b;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:15px; background:#ffeb3b; color:#000; font-size:16px; margin-top:8px" onclick="clickMultiUse('lightning')">–ó–ê–†–Ø–î–ò–¢–¨!</button>
        </div>

        <div class="decor-slot">
            <div style="display:flex; justify-content:space-between; font-size:14px; margin-bottom:8px">
                <span>üåü –ó–≤–µ–∑–¥–æ–ø–∞–¥</span>
                <span id="starfall-ready">0/28</span>
            </div>
            <div class="progress-bg">
                <div id="bar-starfall-ready" class="progress-fill" style="background: #ffc107;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:15px; background:#ffc107; color:#000; font-size:16px; margin-top:8px" onclick="clickMultiUse('starfall')">–ó–ê–ü–£–°–¢–ò–¢–¨!</button>
        </div>

        <div class="decor-slot">
            <div style="display:flex; justify-content:space-between; font-size:14px; margin-bottom:8px">
                <span>üéà –í–æ–∑–¥—É—à–Ω—ã–µ —à–∞—Ä—ã</span>
                <span id="balloons-ready">0/22</span>
            </div>
            <div class="progress-bg">
                <div id="bar-balloons-ready" class="progress-fill" style="background: #03a9f4;"></div>
            </div>
            <button class="btn-ui" style="width: 100%; padding:15px; background:#03a9f4; font-size:16px; margin-top:8px" onclick="clickMultiUse('balloons')">–ù–ê–î–£–¢–¨!</button>
        </div>
    </div>
    
    <button class="btn-ui" style="width: 100%; background:#f44336; margin-top:15px; font-weight:bold; padding:15px" onclick="toggleEditMode()">–í–´–ô–¢–ò –ò–ó –†–ï–ñ–ò–ú–ê</button>
</div>

<!-- –î–æ–±–∞–≤—å—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö: -->
<div id="action-notice" class="action-notice">–î–µ–π—Å—Ç–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!</div>`

<audio id="bg-music" loop></audio>

<!-- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 3: –§—É—Ç–µ—Ä —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º ID -->
<footer id="footer-text">‚Ä¶—Å–∫–æ—Ä–æ</footer>

<!-- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 4: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ç—Ä–µ–∫–µ —Å –¥–∏—Å–∫–æ–º -->
<div id="music-notice" class="music-notice">
  <div class="disc-wrapper">üíø</div>
  <div class="track-info">
    <div class="track-label">–°–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç</div>
    <div id="track-name" class="track-title">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞</div>
  </div>
</div>

</body>
</html>

<span id="footer-text"></span>

<script>
// --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ---
const firebaseConfig = {
    apiKey: "AIzaSyAsEo7_9cdqINcm3tJIO_4yxL_iuKgasY4",
    authDomain: "new-year-calendar.firebaseapp.com",
    databaseURL: "https://new-year-calendar-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "new-year-calendar",
    storageBucket: "new-year-calendar.firebasestorage.app",
    messagingSenderId: "144216155978",
    appId: "1:144216155978:web:49352897f21faf7b5603b3",
    measurementId: "G-M2D1RZWLFL"
};

let fxInterval = null;
let fxInterval2 = null;

if (!firebase.apps.length) {
    firebase.initializeApp(firebaseConfig);
}
const db = firebase.database();

let userName = "–ê–Ω–æ–Ω–∏–º"; 
let currentSkin = 'default';
let isMusicPlaying = false;
let musicNoticeTimer = null;

// –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 4: –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ç—Ä–µ–∫–∞
function showMusicNotice(trackName) {
    const notice = document.getElementById('music-notice');
    const title = document.getElementById('track-name');
    
    if (!notice || !title) return;

    // –£–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ä—ã–π —Ç–∞–π–º–µ—Ä
    if (musicNoticeTimer) clearTimeout(musicNoticeTimer);

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞
    title.textContent = trackName;
    
    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    notice.classList.add('active');
    
    // –°–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã
    musicNoticeTimer = setTimeout(() => {
        notice.classList.remove('active');
    }, 4000);
}

const audio = document.getElementById('bg-music');

// –ú—É–∑—ã–∫–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
const musicTracks = {
    default: 'default.mp3',
    kookoo: 'kookoo.mp3',
    minecraft: 'minecraft.mp3',
    demonslayer: 'demonslayer.mp3',
    neon: 'neon.mp3',
    pixel: 'pixel.mp3',
    starfield: 'starfield.mp3',
    galaxy: 'galaxy.mp3',
    sorrow: 'sorrow.mp3',
    fire: 'fire.mp3'
};

const trackNames = {
    default: 'Christmas bells',
    kookoo: 'Beyond the surface - Sebastian "vey" Fennec',
    minecraft: 'C418 ‚Äî Sweden',
    demonslayer: 'Kamado tanjiro no uta lofi - luvbyrd',
    neon: 'M.O.O.N - Dust',
    pixel: 'Toby fox - Snowdin town',
    starfield: 'Stargazing With Anomalous Intent [Buak OST Lo-Fi Remixes]',
    galaxy: 'Interstellar - S.T.A.Y',
    sorrow: 'Silent Hill 2 - Promise',
    fire: 'A Fire In Your Mind - Kenneth M C Young'
};

// –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 4: –ü–ª–µ–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç—É—Å, —Ç—Ä–µ–∫ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏
function toggleMusic() {
    const player = document.querySelector('.music-player');
    const statusText = document.getElementById('music-status');
    
    if (isMusicPlaying) {
        audio.pause();
        if (player) player.classList.remove('playing');
        isMusicPlaying = false;
        if (statusText) statusText.textContent = "–ú—É–∑—ã–∫–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞";
    } else {
        isMusicPlaying = true;
        if (player) player.classList.add('playing');
        if (statusText) statusText.textContent = "–ú—É–∑—ã–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞";
        playMusicForSkin(currentSkin); // –ò—Å–ø–æ–ª—å–∑—É–µ–º currentSkin
    }
}
function playMusicForSkin(skin) {
    // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∫–∏–Ω–∞
    const normalizedSkin = skin.toLowerCase();
    
    if (musicTracks[normalizedSkin]) {
        const newSrc = musicTracks[normalizedSkin];
        if (audio.src.indexOf(newSrc) === -1) {
            audio.src = newSrc;
            audio.loop = true; 
            audio.load();
        }
        if (isMusicPlaying) {
            audio.play().catch(err => console.log("–ù—É–∂–µ–Ω –∫–ª–∏–∫ –¥–ª—è –º—É–∑—ã–∫–∏"));
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ç—Ä–µ–∫–∞
            showMusicNotice(trackNames[normalizedSkin] || '–ò–≥—Ä–∞–µ—Ç –º—É–∑—ã–∫–∞');
        }
    }
}

// –¢–∞–π–º–µ—Ä
function computeTarget(){
    const now = new Date();
    const nextYear = now.getFullYear() + 1;
    return new Date(`January 1, ${nextYear} 00:00:00`);
}

function updateTimer(){
    const timerEl = document.getElementById('timer');
    if(!timerEl) return;
    const now = new Date();
    const diff = computeTarget() - now;
    if(diff <= 0){ timerEl.textContent = '–° –ù–æ–≤—ã–º –ì–æ–¥–æ–º! üéâ'; return; }
    const d = Math.floor(diff / (1000*60*60*24));
    const h = String(Math.floor((diff / (1000*60*60)) % 24)).padStart(2,'0');
    const m = String(Math.floor((diff / (1000*60)) % 60)).padStart(2,'0');
    const s = String(Math.floor((diff / 1000) % 60)).padStart(2,'0');
    timerEl.textContent = `${d}–¥ ${h}—á ${m}–º ${s}—Å`;
}
setInterval(updateTimer, 1000); 
updateTimer();

// –ö–∞–ª–µ–Ω–¥–∞—Ä—å
const calendarEl = document.getElementById('calendar');
const openedDays = JSON.parse(localStorage.getItem('openedDays') || '[]');

function initCalendar() {
    if(!calendarEl) return;
    calendarEl.innerHTML = '';
    for(let i=1; i<=31; i++){
        const d = document.createElement('div');
        d.className = 'day';
        d.textContent = i;
        d.dataset.day = i;
        if(openedDays.includes(i)) d.classList.add('opened');

        const today = new Date();
        const isDecember = today.getMonth() === 11;
        if(isDecember && i <= today.getDate()){
            d.onclick = () => openDay(i);
        } else {
            d.classList.add('locked');
        }
        calendarEl.appendChild(d);
    }
}
initCalendar();

function openDay(n){
    const dayEl = document.querySelector(`.day[data-day="${n}"]`);
    if(!dayEl || dayEl.classList.contains('locked')) return;
    
    if(!openedDays.includes(n)){
        openedDays.push(n);
        localStorage.setItem('openedDays', JSON.stringify(openedDays));
        dayEl.classList.add('opened');
    }

      if (n === 31) {
        // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
        window.location.href = '31.html';
        return; // –ü—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, —á—Ç–æ–±—ã alert –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è
    }
    
    const messages = {
        1: "–ü–µ—Ä–≤—ã–π –¥–µ–Ω—å –∑–∏–º—ã –∞? –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ?",
      2: "–£–∂–µ –≤—Ç–æ—Ä–æ–π....–µ–ª–∫—É –±—É–¥–µ—à—å —Å—Ç–∞–≤–∏—Ç—å?",
      3: "–¢—Ä–µ—Ç–∏–π –¥–µ–Ω—å...–ø–æ–∑–≤–æ–Ω–∏ –±–∞–±—É—à–∫–µ, –∏–ª–∏ –æ–±–Ω–∏–º–∏ –º–∞–º—É —Å –ø–∞–ø–æ–π, —è —É–≤–µ—Ä–µ–Ω –æ–Ω–∏ –±—É–¥—É—Ç —Ä–∞–¥—ã)",
      4: "–ß–µ—Ç–≤–µ—Ä—Ç—ã–π –¥–µ–Ω—å...—Ç—ã –º–æ–ª–æ–¥–µ—Ü, —Ç–≤–æ–∏ –ø–æ—Å—É–ø–∫–∏ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –Ω–µ–∑–∞–º–µ—á–µ–Ω–Ω—ã–º–∏!",
      5: "–£—Ä–∞ —Ñ–∏–ª—å–º –ø–æ –≤—Ç–æ—Ä–æ–º—É –§–Ω–∞—Ñ—É! :D",
      6: "–°–µ–≥–æ–¥–Ω—è –Ω–∞ —Ñ–∏–ª—å–º –ø–æ –§–Ω–∞—Ñ—É 2 –ø–æ–π–¥–µ—Ç–µ?",
      7: "–ê —Å–µ–≥–æ–¥–Ω—è –Ω–∞ —Ñ–∏–ª—å–º –ø–æ –§–Ω–∞—Ñ—É 2 –∏–¥–µ—Ç–µ? –ù–∞–¥–æ –±—ã! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞)",
      8: "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –¥–µ–Ω—å –≤—Å–µ–≥–¥–∞ —Ç—è–∂–µ–ª—ã–π, –Ω–æ —Ç—ã —Å–∏–ª—å–Ω—ã–π —Ç—ã —Å–ø—Ä–∞–≤–∏—à—å—Å—è, —è –≤ —Ç–µ–±—è –≤–µ—Ä—é!",
      9: "–Ø –ø—Ä–∞–≤–¥–∞ –≥–æ—Ä–∂—É—Å—å —Ç–æ–±–æ–π, —Ç—ã –º–æ–ª–æ–¥–µ—Ü —Å—Ç–æ–ª—å–∫–æ –≤—Å–µ–≥–æ —Å–¥–µ–ª–∞—Ç—å –≤ —ç—Ç–æ–º –≥–æ–¥—É, —è–≤–Ω–æ –ø–æ–≤–æ–¥ –¥–ª—è –≥–æ—Ä–¥–æ—Å—Ç–∏!",
      10: "–ù–µ—Ç, –ø—Ä–∞–≤–¥–∞, –∫—Ç–æ –±—ã —Ç—ã –Ω–∏ –±—ã–ª –ø–æ —Ç—É —Å—Ç–æ—Ä–æ–Ω—É —ç–∫—Ä–∞–Ω–∞, —è –æ–±–æ–∂–∞—é —Ç–µ–±—è, —Å–ø–∞—Å–∏–±–æ –∑–∞ —Ç–≤–æ–∏ –ø–æ—Å—Ç—É–ø–∫–∏ –∏ —É—á–∞—Å—Ç–∏–µ –≤ –Ω–∞—à–µ–π –∂–∏–∑–Ω–∏ –≥—Ä—É–ø–ø—ã!",
      11: "–í–æ—Ç —É–∂–µ –∏ —á–µ—Ç–≤–µ—Ä–≥! –°–∫–æ—Ä–æ –≤—ã—Ö–æ–¥–Ω—ã–µ, —Å —Ä–µ–±—è—Ç–∞–º–∏ —Ç–æ –ø–æ–π–¥–µ—à—å –≥—É–ª—è—Ç—å? –ù–∞–¥–æ –±—ã –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º –≥–æ–¥–æ–º!",
      12: "–ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å –≤—Ç–æ—Ä–æ–π –Ω–µ–¥–µ–ª–∏! –ú–æ–ª–æ–¥–µ—Ü —á—Ç–æ –¥–æ—à–µ–ª –∏ –Ω–µ —Å–¥–∞–ª—Å—è, —É–º–Ω–∏—á–∫–∞! :3",
      13: "–í—ã—Ö–æ–¥–Ω—ã–µ —É–∂–µ –∑–¥–µ—Å—å, –∏ –ø–æ–ª–æ–≤–∏–Ω–∞ –¥–µ–∫–∞–±—Ä—è —É–∂–µ –∫–∞–∫ –∏ –Ω–µ –±—ã–≤–∞–ª–æ, –∂–µ–ª–∞—é —É–¥–∞—á–∏!",
      14: "–ï–ª–∫—É –ø–æ—Å—Ç–∞–≤–∏–ª? –ê –≥–∏—Ä–ª—è–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç? –ê —Ä–µ–±—è—Ç–∞–º –ø–æ–¥–∞—Ä–∫–∏ —Å–¥–µ–ª–∞–ª? –ê–π –º–æ–ª–æ–¥—Ü–∞!",
      15: "–°–µ—Å—Å–∏—è —É —Ç–µ–±—è –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ —É–∂–µ –∏–¥–µ—Ç? –î–µ—Ä–∂–∏—Å—å, –∫–∞–∫ –±—ã –Ω–∏ –±—ã–ª–æ —Ç—è–∂–µ–ª–æ –ø–æ–¥–Ω–∏–º–∏ –≥–æ–ª–æ–≤—É –≤–≤–µ—Ä—Ö –∏ –∏–¥–∏ –≤–ø–µ—Ä–µ–¥, –≥–æ—Ä–¥–æ!",
      16: "–ù—É —á—Ç–æ, –≤—Ç–æ—Ä–∞—è –Ω–µ–¥–µ–ª—è –ø–æ–∑–∞–¥–∏, –µ—â–µ 2 –≤–ø–µ—Ä–µ–¥–∏! ",
      17: "–Ø –ª—é–±–ª—é —Ç–µ–±—è, –∏ –Ω–∏—á–µ–≥–æ —ç—Ç–æ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç, —Å–ø–∞—Å–∏–±–æ –∑–∞ —Ç–≤–æ–π –≤–∫–ª–∞–¥ –≤ –≥—Ä—É–ø–ø—É...",
      18: "–ü–æ–ª –Ω–µ–¥–µ–ª–∏ —É–∂–µ –ø—Ä–æ—à–ª–æ, –≤—Å–µ–≥–æ –Ω–∏—á–µ–≥–æ –æ—Å—Ç–∞–ª–æ—Å—å, –≤–ø–µ—Ä–µ–¥!",
      19: "–í–æ—Ç –∏ –æ—á–µ—Ä–µ–¥–Ω–∞—è –ø—è—Ç–Ω–∏—Ü–∞! –ó–∞–≤—Ç—Ä–∞ —É–∂–µ –≤—ã—Ö–æ–¥–Ω—ã–µ, –æ—Ç–¥—ã—Ö–∞–π –∏ –Ω–µ –∑–∞–±—ã–≤–∞–π –ø—Ä–æ –º–µ–Ω—è :)",
      20: "–°—É–±–±–æ—Ç–∞, –∫–∞–∫ –Ω–∞—Å—á–µ—Ç –ø–æ–≥—É–ª—è—Ç—å —Å —Ä–µ–±—è—Ç–∞–º–∏? –ò–ª–∏ –º–æ–∂–µ—Ç –µ—â–µ —á—Ç–æ –≤—ã–¥—É–º–∞—Ç—å...",
      21: "–Ø –≤—Å–µ–≥–¥–∞ –≤–∏–¥–µ–ª –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –∫–∞–∫ —Å–∞–º—ã–π –ª–µ–Ω–∏–≤—ã–π –¥–µ–Ω—å, –Ω–æ –µ—Å–ª–∏ –Ω–µ –ª–µ–Ω—å –≥—É–ª—è–π –∏ –∏–≥—Ä–∞–π —Å —Ä–µ–±—è—Ç–∞–º–∏, —è —É–≤–µ—Ä–µ–Ω –æ–Ω–∏ —Ö–æ—Ç—è—Ç —Ç–µ–±—è –≤–∏–¥–µ—Ç—å!",
      22: "–ü–æ—Å–ª–µ–¥–Ω—è—è –Ω–µ–¥–µ–ª—è, –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä—ã–≤–æ–∫, –Ω–∏ —à–∞–≥—É –Ω–∞–∑–∞–¥, —Ç–æ–ª—å–∫–æ –≤–ø–µ—Ä–µ–¥, —è –≤ —Ç–µ–±—è –≤–µ—Ä—é! –° –¥–Ω–µ–º —Ä–æ–∂–¥–µ–Ω–∏—è, –•—ë–∫–∞!",
      23: "–û–±–Ω–∏–º–∏ —Å–≤–æ–∏—Ö –ª—é–±–∏–º—ã—Ö –ª—é–¥–µ–π, –ø–∏—Ç–æ–º—Ü–µ–≤, —Å–∫–∞–∂–∏ –∫–∞–∫ –æ–Ω–∏ –≤–∞–∂–Ω—ã –¥–ª—è —Ç–µ–±—è, –∫–∞–∂–¥—ã–π –±—ã–ª –±—ã —Ä–∞–¥ —ç—Ç–æ —É—Å–ª—ã—à–∞—Ç—å!",
      24: "–¢—ã —Å–º–æ—Ç—Ä–∏, –≤–æ—Ç –∏ –ø–æ–ª–æ–≤–∏–Ω–∞ –Ω–µ–¥–µ–ª–∏ –ø—Ä–æ—à–ª–æ, –¥–∞? –ò –∫ —Å–ª–æ–≤—É –Ω–∞–∫–æ–Ω–µ—Ü —Ç–æ –û—Å–æ–±–Ω—è–∫ –ë–∞–ª—å–º—Å—Ç–µ—Ä –≤—ã—à–µ–ª, –º–æ–ª–æ–¥–µ—Ü –ê—è–Ω–∞ —á—Ç–æ –¥–æ–¥–µ–ª–∞–ª–∞ –µ–≥–æ!",
      25: "–ß—Ç–æ –±—ã–ª–æ –ø–µ—Ä–≤–æ–µ, –∫—É—Ä–∏—Ü–∞ –∏–ª–∏ —è–π—Ü–æ? –î–∞ —Ö–æ—Ç—è –∫–∞–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞, –≥–ª–∞–≤–Ω–æ–µ —á—Ç–æ —Ç—ã —É–º–Ω–∏—á–∫–∞ –∏ –ø–æ—á—Ç–∏ —Å–ø—Ä–∞–≤–∏–ª—Å—è!",
      26: "–í–æ—Ç –æ–Ω, –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å —Ä–∞–±–æ—á–µ–π –Ω–µ–¥–µ–ª–∏ (—è –∫–∞–∫ –º–∏–Ω–∏–º—É–º –Ω–∞–¥–µ—é—Å—å —á—Ç–æ —É —Ç–µ–±—è —Ç–∞–∫!) –≤—Å–µ–≥–æ –Ω–∏—á–µ–≥–æ –¥–æ –Ω–æ–≤–æ–≥–æ –≥–æ–¥–∞, —Ç—ã –º–æ–ª–æ–¥–µ—Ü!",
      27: "–í–æ—Ç –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—É–±–±–æ—Ç–∞ –≤ —ç—Ç–æ–º –≥–æ–¥—É, –≥—É–ª—è—Ç—å –±—É–¥–µ—à—å? –ò–ª–∏ –º–æ–∂–µ—Ç –≤ –¥–∏—Å–∫–æ—Ä–¥–µ —Å–æ–±–µ—Ä–µ—Ç–µ—Å—å?",
      28: "–ò –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, –Ω–∞–ø–æ–º–Ω–∏ —Å–≤–æ–∏–º —Ä–æ–¥–Ω—ã–º –∏ –±–ª–∏–∑–∫–∏–º —á—Ç–æ –æ–Ω–∏ –Ω–µ –ø—É—Å—Ç–æ–π –∑–≤—É–∫ –≤ —Ç–≤–æ–µ–π –∂–∏–∑–Ω–∏, —É–≤–µ—Ä–µ–Ω –∏–º –Ω–∞–¥–æ —ç—Ç–æ —É—Å–ª—ã—à–∞—Ç—å!",
      29: "–ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ —ç—Ç–æ–º –≥–æ–¥—É.....–≤—Å–µ–≥–æ –Ω–∏—á–µ–≥–æ –¥–∞? –ö–∞–∫ –æ—â—É—â–µ–Ω–∏—è? –£ –º–µ–Ω—è –≤—Å–µ–≥–¥–∞ –≤–æ–ª–Ω–µ–Ω–∏–µ –∏ –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ...",
      30: "–í–æ—Ç –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º –≥–æ–¥–æ–º, –ø–æ—Ä–∞ –≥–æ—Ç–æ–≤–∏—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å –≤—Å–µ, –ø–æ–¥–∞—Ä–∫–∏, –µ–ª–∫—É, –º–∏—à—É—Ä—É, –≥–∏—Ä–ª—è–Ω–¥—ã –∏ –∫–æ–Ω–µ—á–Ω–æ —Å–≤–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ!",
      31: "–í–æ—Ç –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å, –Ω—É —á—Ç–æ —Å–∫–∞–∑–∞—Ç—å, —Å–ø–∞—Å–∏–±–æ —á—Ç–æ –±—ã–ª —Å–æ –º–Ω–æ–π –≤ —ç—Ç–æ–º –≥–æ–¥—É, —Å–ø–∞—Å–∏–±–æ —á—Ç–æ –ø–æ—Å–µ—â–∞–µ—à—å —ç—Ç–æ—Ç —Å–∞–π—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è —Å—é–¥–∞ –∏–∑ —Ä–∞–∑–∞ –≤ —Ä–∞–∑, —è —Ç–µ–±—è –ª—é–±–ª—é, —Å –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–º –Ω–æ–≤—ã–º –≥–æ–¥–æ–º!"
    };
    alert(messages[n] || `–î–µ–Ω—å ${n} ‚Äî —Å–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —á—Ç–æ-—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ! üéÖ`);
}

const phrases = [
    "–¢—ã –ø–æ—á—Ç–∏ –¥–æ–∂–∏–ª –¥–æ –ø—Ä–∞–∑–¥–Ω–∏–∫–∞!",
    "–ü–æ—Ä–∞ –≥–æ—Ç–æ–≤–∏—Ç—å –ø–æ–¥–∞—Ä–∫–∏...",
    "2026 —É–∂–µ –Ω–∞ –ø–æ–¥—Ö–æ–¥–µ!",
    "–í—Ä–µ–º—è –∏–¥—ë—Ç. –°–Ω–µ–≥ –∏–¥—ë—Ç. –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è!",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –£ –ö–æ—Å—Ç–∏ –µ—Å—Ç—å –±–æ–ª–µ–µ 30 –∫–æ—Å–ø–ª–µ–µ–≤!",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –ö–∏—Ä–∏–ª–ª –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –≤—Å—Ç—É–ø–∏–ª –≤ –≥—Ä—É–ø–ø—É 29 –ò—é–Ω—è 2025 –≥–æ–¥–∞!",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –£ –ê–ª–∞–Ω–∞ –±–æ–ª—å—à–µ –≤—Å–µ—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –≤ –¢–ì–ö! –ê —Å—Ç–æ–ø –∏–ª–∏ —É –ö–æ—Å—Ç–∏?....",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –ê—è–Ω–∞ –ø–µ—Ä–≤–∞—è –∫—Ç–æ —Å–¥–µ–ª–∞–ª–∞ –∞—Ä—Ç—ã –ø–æ –Ω–∞—à–∏–º –≥—É–ª—è–Ω–∏—è–º, –∏ –ø–µ—Ä–≤–∞—è –∫—Ç–æ –Ω–∞—á–∞–ª –¥–µ–ª–∞—Ç—å –∞—É—à–∫–∏!",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –í –≥—Ä—É–ø–ø–µ –±—ã–ª–æ –∑–∞–ø–æ—Å—á–µ–Ω–æ —É–∂–µ –±–æ–ª–µ–µ 2500 –∫–∞—Ä—Ç–∏–Ω–æ–∫...–ø–æ—Ä–∞ —á–∏—Å—Ç–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω...",
    "–ö–∞–∫ –Ω–∞—Å—á–µ—Ç –ø–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ —Ñ–æ–Ω –º—É–∑—ã–∫–∏? https://www.youtube.com/watch?v=LYHAEnZx9YI",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –Ø –≤–∞—Å –ª—é–±–ª—é –±–æ–ª—å—à–µ –≤—Å–µ—Ö, –∏ –Ω–∏—á–µ–≥–æ —ç—Ç–æ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –£ –Ω–∞—Å –µ—Å—Ç—å –≥—Ä—É–ø–ø–∞ –≤ –î–∏—Å–∫–æ—Ä–¥–µ! –ü–æ—á–µ–º—É –≤—ã –µ—â–µ –Ω–µ —Ç–∞–º?)",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –•–µ–∫–∞ –Ω–µ –æ—á–µ–Ω—å –ª—é–±–∏—Ç –∫–æ—Å–ø–ª–µ–π –Ω–∞ –ú–∏—Ç—Å—É—Ä–∏, –æ–Ω–∞ –±—ã —Å —Ä–∞–¥–æ—Å—Ç—å—é –∑–∞–∫–æ—Å–ø–ª–µ–∏–ª–∞ –¥—Ä—É–≥–∏–µ –Ω–æ –¥–µ–Ω—å–≥–∏ –Ω–µ —Ä–µ–∑–∏–Ω–æ–≤—ã–µ...",
    "–ò–ª—å—è—Å, –Ω–µ –∑–∞–±—É–¥—å, –Ω–∞–¥–æ –∑–∞ —ç—Ç–æ –≤—ã–ø–∏—Ç—å!",
    "–ü–æ—á–µ–º—É —Å–ª–µ–ø–æ–π –º–∞–ª—å—á–∏–∫ —É—Ä–æ–Ω–∏–ª –º–æ—Ä–æ–∂–µ–Ω–Ω–æ–µ? –ü–æ—Ç–æ–º—É —á—Ç–æ –µ–≥–æ —Å–±–∏–ª–∞ —Ñ—É—Ä–∞!",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –ê—è–Ω–∞ –¥—Ä–µ–≤–Ω–µ –∫–∞–∑–∞—Ö—Å–∫–∞—è –±–æ–≥–∏–Ω—è –∑–∏–º—ã –∏ —Ö–æ–ª–æ–¥–∞! –ò —ç—Ç–æ –¥–∞–∂–µ –Ω–µ —è –Ω–∞–ø–∏—Å–∞–ª, –∞ –∏–∏ —Å–∞–º –≤—Å—Ç–∞–≤–∏–ª!",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –ê—è–Ω–∞ –¥—Ä–µ–≤–Ω–µ –∫–∞–∑–∞—Ö—Å–∫–∞—è –∏—Ç–∞–ª—å—è–Ω–∫–∞",
    "–ê—è–Ω–∞ –Ω–∞–ø–∏—Å–∞–ª–∞ 4 –∞—É—à–∫–∏ –ø–æ –Ω–∞–º: –ó–ê–ë–´–¢–´–ô –û–°–û–ë–ù–Ø–ö –ë–ê–õ–¨–ú–°–¢–ï–†, –∏ –•–†–û–ù–ò–ö–ò –ü–ê–î–®–ò–•, –ú–∞—Ñ–∏—è –ê–£,–°–æ–≤–º–µ—Å—Ç–Ω–∞—è –∂–∏–∑–Ω—å –ê–£,–Ω—É –∏ —Ç–∞–∫–∂–µ –µ—â–µ –±–µ—Å—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∏—Å—É–Ω–æ—á–∫–æ–≤!",
    "–ö–∞–∫ —Ç–æ –Ω–∞ —É–ª–∏—Ü–µ —è —É–≤–∏–¥–µ–ª 2 –ø–∞—Ä–Ω–µ–π –≤ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –æ–¥–µ–∂–¥–µ, –ø–æ–¥–æ—à–µ–ª –∏ —Å–ø—Ä–æ—Å–∏–ª –Ω–µ –≥–µ–∏ –ª–∏ –æ–Ω–∏, –æ–Ω–∏ –º–µ–Ω—è –∞—Ä–µ—Å—Ç–æ–≤–∞–ª–∏...",
    "–ö–æ–≥–¥–∞ –Ω–∏–±—É–¥—å –º—ã —ç—Ç–æ –ø–æ–≤—Ç–æ—Ä–∏–º....https://vm.tiktok.com/ZMSXp6pok/",
    "'–ó–∞—Ç–æ —è –ø–µ—Ç—É—Ö...'",
    "–Æ–∫–∏, –∏–¥–∏ –∫—É—à–∞–π, –∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –£ –Ω–∞—Å –≤ –≥—Ä—É–ø–ø–µ –µ—Å—Ç—å –ø—Ä–∞–≤–∏–ª–∞! –í—ã –æ–± —ç—Ç–æ–º –Ω–µ –∑–Ω–∞–ª–∏? –Ø —Ç–æ–∂–µ!",
    "–ó–∞–±—ã—Ç—ã–π –æ—Å–æ–±–Ω—è–∫ –ë–∞–ª—å–º—Å—Ç–µ—Ä - —ç—Ç–æ –∏–º–±–∞!",
    "–≠–ª–∏—Ñ (–∏–ª–∏ –∂–µ –∫–∞–∫ —è –Ω–∞–∑—ã–≤–∞—é –ª–∏—Ñ), –Ω–∞—à –ª—É—á—à–∏–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ >:3",
    "–ò–ª—å—è—Å —Ä–∞–±–æ—Ç–∞–ª –Ω–∞ –∑–∞–≤–æ–¥–µüíÄüíÄ",
    "–í–µ–Ω—è –∏ –õ–∏–º–æ–Ω –º–Ω–µ –æ–±–µ—â–∞–ª–∏ –∫–æ—Å–ø–ª–µ–π –Ω–∞ –±–∞–π–∫–µ—Ä–∞, –Ω–æ –æ–±–∞ —Ç–∞–∫ –∏ –Ω–µ —Å–¥–µ–ª–∞–ª–∏, —Ö–æ–¥–∏—Ç–µ –æ–≥–ª—è–¥—ã–≤–∞–π—Ç–µ—Å—å...",
     "–°–∫–æ—Ä–æ –ù–æ–≤—ã–π –ì–æ–¥!",
    "–û—Å—Ç–∞–ª–æ—Å—å —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏...",
    "–ì–æ—Ç–æ–≤–∏—à—å—Å—è –∫ –ø—Ä–∞–∑–¥–Ω–∏–∫—É? üéÑ"
];

let currentPhraseIndex = 0;

// –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø —Ñ—É–Ω–∫—Ü–∏—è updatePhrase:
function updatePhrase(){ 
    const footerText = document.getElementById('footer-text');
    if(!footerText) return;
    
    // Fade out
    footerText.style.opacity = '0';
    
    // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è fade-out, –ø–æ—Ç–æ–º –º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç
    setTimeout(() => {
        // –ú–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç
        footerText.textContent = phrases[currentPhraseIndex];
        currentPhraseIndex = (currentPhraseIndex + 1) % phrases.length;
        
        // Fade in
        setTimeout(() => {
            footerText.style.opacity = '1';
        }, 50);
    }, 500); // –ñ–¥–µ–º –ø–æ–ª—Å–µ–∫—É–Ω–¥—ã –¥–ª—è fade-out
}

// –ó–∞–ø—É—Å–∫–∞–µ–º —Å–º–µ–Ω—É —Ñ—Ä–∞–∑ –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
setInterval(updatePhrase, 15000); 

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é —Ñ—Ä–∞–∑—É —Å—Ä–∞–∑—É
updatePhrase();

// –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 2: clearFX —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–¥–∞–ª—è–µ—Ç –≤—Å–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
// –û–±–Ω–æ–≤–∏—Ç–µ clearFX - –ù–ï —Ç—Ä–æ–≥–∞–µ–º –º—É–∑—ã–∫–∞–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É:
function clearFX() {
    console.log('Clearing all FX');
    
    // –£–¥–∞–ª—è–µ–º –≤—Å–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
    document.querySelectorAll('.fx, .lightning-flash, .neon-overlay, .garland, .nebula, .galaxy-vortex, .neon-circles, .minecraft-wrap, .creeper-silhouette, .starfield-nebula, .space-planet,.firestorm-overlay, .kookoo-content, .fire-particle').forEach(n => n.remove());

    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
    if (fxInterval) { clearInterval(fxInterval); fxInterval = null; }
    if (fxInterval2) { clearInterval(fxInterval2); fxInterval2 = null; }

    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∏–ª–∏ body
    document.body.className = ''; 
    document.body.style.background = '';
    document.body.style.overflow = '';
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
    const calendar = document.getElementById('calendar');
    if (calendar) calendar.style.display = '';
    
    // –ú—É–∑—ã–∫–∞–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –≤–∏–¥–∏–º–æ–π - –ù–ï —Ç—Ä–æ–≥–∞–µ–º –µ—ë!
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
    const timer = document.getElementById('timer');
    if (timer) {
        timer.className = '';
        timer.style.display = ''; 
        timer.style.transform = '';
        timer.style.transition = '';
    }
}

// --- –§–£–ù–ö–¶–ò–ò –ò–ù–¢–ï–†–§–ï–ô–°–ê ---

function saveName(event) {
    if (event) { event.preventDefault(); }
    const input = document.getElementById('user-name-input');
    userName = (input && input.value.trim()) ? input.value.trim() : "–ê–Ω–æ–Ω–∏–º";
    
    const modal = document.getElementById('name-modal');
    if(modal) modal.style.display = 'none';
    startPresence(userName);
}

function toggleMenu() {
    const menu = document.getElementById('menu');
    if (menu) menu.classList.toggle('open');
}

function toggleEditMode() {
    const wrapper = document.getElementById('main-content-wrapper');
    const panel = document.getElementById('decoration-panel');
    if (!wrapper || !panel) return;

    const isActive = document.body.classList.contains('edit-mode-active');
    
    if (!isActive) {
        // –í–∫–ª—é—á–∞–µ–º —Ä–µ–∂–∏–º —É–∫—Ä–∞—à–µ–Ω–∏—è
        document.body.classList.add('edit-mode-active');
        panel.classList.add('active');
    } else {
        // –í—ã–∫–ª—é—á–∞–µ–º —Ä–µ–∂–∏–º —É–∫—Ä–∞—à–µ–Ω–∏—è
        document.body.classList.remove('edit-mode-active');
        panel.classList.remove('active');
    }
}

// –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø —Ñ—É–Ω–∫—Ü–∏—è setSkin
function setSkin(skin) {
    console.log('Switching skin to:', skin);
    
    // –û—á–∏—â–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–∫–∏–Ω–∞
    clearFX();
    
    // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∫–∏–Ω–∞
    const normalizedSkin = skin.toLowerCase();
    currentSkin = normalizedSkin;
    
    console.log('Applying skin:', normalizedSkin);
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–∫–∏–Ω–æ–≤
    switch(normalizedSkin) {
        case 'kookoo': 
            applyKooKoo(); 
            break;
        case 'sorrow': 
            applySorrow(); 
            break;
        case 'fire': 
            applyFire(); 
            break;
        case 'neon': 
            applyNeon(); 
            break;
        case 'pixel': 
            applyPixel(); 
            break;
        case 'starfield': 
            applyStarfield(); 
            break;
        case 'galaxy': 
            applyGalaxy(); 
            break;
        case 'minecraft': 
            applyMinecraft(); 
            break;
        case 'demonslayer': 
            applyDemonSlayer(); 
            break;
        default: 
            applyDefault();
    }
    
    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –º—É–∑—ã–∫—É –ü–û–°–õ–ï –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–∫–∏–Ω–∞
    if (isMusicPlaying) {
        playMusicForSkin(normalizedSkin);
    }
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞
    const menu = document.getElementById('menu');
    if (menu) menu.classList.remove('open');
    
    console.log('Skin applied successfully');
}


// --- –ö–û–ù–ö–†–ï–¢–ù–´–ï –ü–†–ï–°–ï–¢–´ ---

function applyDefault() {
    clearFX();
    document.body.classList.add('default-skin');
    const timer = document.getElementById('timer');
    timer.className = '';
    
    // –ó–∞–ø—É—Å–∫ –ø–∞–¥–∞—é—â–∏—Ö —Å–Ω–µ–∂–∏–Ω–æ–∫
    fxInterval = setInterval(() => {
        const el = document.createElement('div');
        el.className = 'fx snow';
        el.textContent = '‚ùÑ';
        el.style.position = 'fixed';
        el.style.left = Math.random() * 100 + 'vw';
        el.style.top = '-20px';
        el.style.color = 'white';
        el.style.fontSize = (10 + Math.random() * 20) + 'px';
        el.style.zIndex = '1000';
        el.style.pointerEvents = 'none';

        document.body.appendChild(el);

        const duration = 5000 + Math.random() * 5000;
        el.animate([
            { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
            { transform: `translateY(110vh) rotate(${Math.random() * 360}deg)`, opacity: 0.3 }
        ], {
            duration: duration,
            easing: 'linear'
        }).onfinish = () => el.remove();
    }, 200);

    // –°–æ–∑–¥–∞–Ω–∏–µ –≥–∏—Ä–ª—è–Ω–¥—ã
    const g = document.createElement('div'); 
    g.className = 'garland fx';
    
    g.style.position = 'absolute';
    g.style.top = '70px'; 
    g.style.left = '0';
    g.style.width = '100%';
    g.style.display = 'flex';
    g.style.justifyContent = 'space-around';
    g.style.pointerEvents = 'none';
    g.style.zIndex = '90';

    const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff'];
    
    for(let i=0; i<30; i++) {
        const l = document.createElement('div'); 
        l.className = 'light';
        l.style.width = '10px';
        l.style.height = '10px';
        l.style.borderRadius = '50%';
        l.style.background = colors[i % colors.length];
        
        l.style.boxShadow = `0 0 10px ${colors[i % colors.length]}`;
        l.style.animation = `blink ${0.5 + Math.random()}s infinite alternate`;
        l.style.animationDelay = (Math.random()) + 's';
        
        g.appendChild(l);
    }
    
    document.body.appendChild(g);
}

function applyMinecraft() {
    clearFX();
    document.body.classList.add('minecraft-skin');
    const timer = document.getElementById('timer');
    timer.classList.add('mc-style');
    
    // –ö—Ä–∏–ø–µ—Ä
    const creeper = document.createElement('div');
    creeper.className = 'creeper-silhouette fx';
    document.body.appendChild(creeper);

    fxInterval = setInterval(() => {
        const el = document.createElement('div');
        el.className = 'fx minecraft-block';
        el.textContent = ['üü´','üü©','‚¨õ','üü¶'][Math.floor(Math.random()*4)];
        el.style.left = Math.random() * 95 + 'vw';
        el.style.top = '-40px';
        document.body.appendChild(el);
        el.animate([{transform: 'translateY(0)'}, {transform: 'translateY(110vh)'}], {duration: 3000}).onfinish = () => el.remove();
    }, 600);
}

// –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï KOOKOO - —Ç–µ–ø–µ—Ä—å —Ç–∞–π–º–µ—Ä –±—É–¥–µ—Ç –≤–∏–¥–µ–Ω
function applyKooKoo() {
    clearFX();
    
    document.body.style.background = '#050010';
    document.body.style.overflow = 'hidden'; // –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É

    // –ü—Ä—è—á–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–π–º–µ—Ä
    const mainTimer = document.getElementById("timer");
    if (mainTimer) mainTimer.style.display = "none";
    
    // –ü—Ä—è—á–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
    const calendar = document.getElementById("calendar");
    if (calendar) calendar.style.display = "none";

    // –°–æ–∑–¥–∞–µ–º KooKoo –æ–±–µ—Ä—Ç–∫—É
    let wrap = document.getElementById("kookoo-wrapper");
    if (!wrap) {
        wrap = document.createElement("div");
        wrap.id = "kookoo-wrapper";
        wrap.className = "fx";
        wrap.innerHTML = `
            <div class="kookoo-content">
                <img class="kookoo-gif" id="kookoo-gif" src="Kookoo_Clock.webp" alt="kookoo">
                <div class="kookoo-timer" id="kookoo-time">--:--:--</div>
            </div>
        `;
        
        // –í—Å—Ç–∞–≤–ª—è–µ–º –≤ main
        const mainContent = document.getElementById('main-content-wrapper');
        if (mainContent) {
            mainContent.appendChild(wrap);
        } else {
            document.body.appendChild(wrap);
        }
    } else {
        wrap.style.display = "block";
        const gif = document.getElementById("kookoo-gif");
        if(gif) gif.src = "Kookoo_Clock.webp";
        const kookooTimer = document.getElementById("kookoo-time");
        if(kookooTimer) kookooTimer.style.display = "block";
    }

    kookooState = "count";
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
    if (!fxInterval2) {
        fxInterval2 = setInterval(updateKookooOverlay, 500);
    }
}

function applyDemonSlayer() {
    clearFX();
    document.body.style.background = '#0d0204';
    const timer = document.getElementById('timer');
    timer.classList.add('demonslayer-style');
    
    // –ü–∞–¥–µ–Ω–∏–µ —Å–∞–∫—É—Ä—ã
    fxInterval = setInterval(() => {
        const el = document.createElement('div');
        el.className = 'fx sakura';
        el.textContent = 'üå∏';
        el.style.position = 'fixed';
        el.style.left = Math.random() * 100 + 'vw';
        el.style.top = '-30px';
        el.style.fontSize = (15 + Math.random() * 15) + 'px';
        el.style.zIndex = '1000';
        el.style.pointerEvents = 'none';
        
        document.body.appendChild(el);
        
        const duration = 6000 + Math.random() * 4000;
        const drift = (Math.random() - 0.5) * 100;
        
        el.animate([
            { transform: 'translateY(0) translateX(0) rotate(0deg)', opacity: 1 },
            { transform: `translateY(110vh) translateX(${drift}px) rotate(${Math.random() * 720}deg)`, opacity: 0.5 }
        ], {
            duration: duration,
            easing: 'ease-in-out'
        }).onfinish = () => el.remove();
    }, 250);
}

function applyFire() {
    clearFX();
    document.body.style.background = 'radial-gradient(circle, #4b0000 0%, #000 100%)';
    const timer = document.getElementById('timer');
    timer.classList.add('firestorm-active');

    // –≠—Ñ—Ñ–µ–∫—Ç –≥–æ—Ä—è—á–µ–≥–æ –≤–æ–∑–¥—É—Ö–∞
    const overlay = document.createElement('div');
    overlay.className = 'firestorm-overlay fx';
    overlay.style.position = 'fixed';
    overlay.style.top = '0';
    overlay.style.left = '0';
    overlay.style.width = '100%';
    overlay.style.height = '100%';
    overlay.style.background = 'linear-gradient(transparent 0%, rgba(255,100,0,0.1) 100%)';
    overlay.style.pointerEvents = 'none';
    overlay.style.zIndex = '10';
    overlay.style.animation = 'heatwave 2s ease-in-out infinite';
    document.body.appendChild(overlay);

    // –û–≥–Ω–µ–Ω–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã
    fxInterval = setInterval(() => {
        const p = document.createElement('div');
        p.className = 'fx fire-particle';
        p.textContent = ['üî•', 'üî•', '‚ú®', 'üî∏'][Math.floor(Math.random() * 4)];
        p.style.position = 'fixed';
        p.style.left = Math.random() * 100 + 'vw';
        p.style.bottom = '-20px';
        p.style.fontSize = Math.random() * 20 + 10 + 'px';
        p.style.zIndex = '1000';
        p.style.pointerEvents = 'none';
        document.body.appendChild(p);

        p.animate([
            { transform: 'translateY(0) scale(1) rotate(0deg)', opacity: 1 },
            { transform: `translateY(-110vh) scale(0) rotate(${Math.random() * 360}deg)`, opacity: 0 }
        ], { duration: 2000 + Math.random() * 1000 }).onfinish = () => p.remove();
    }, 80);

    // –ò—Å–∫—Ä—ã
    fxInterval2 = setInterval(() => {
        const spark = document.createElement('div');
        spark.className = 'fx';
        spark.textContent = '‚ú®';
        spark.style.position = 'fixed';
        spark.style.left = Math.random() * 100 + 'vw';
        spark.style.top = Math.random() * 100 + 'vh';
        spark.style.fontSize = '8px';
        spark.style.zIndex = '1000';
        spark.style.pointerEvents = 'none';
        document.body.appendChild(spark);
        
        spark.animate([
            { opacity: 1, transform: 'scale(1)' },
            { opacity: 0, transform: 'scale(0)' }
        ], { duration: 500 }).onfinish = () => spark.remove();
    }, 200);
}


function applyNeon() {
    clearFX();
    document.body.style.background = '#0a0a1a';
    const timer = document.getElementById('timer');
    timer.classList.add('neon');
    
    // –ù–µ–æ–Ω–æ–≤—ã–µ –∫—Ä—É–≥–∏
    const colors = ['#ff00ff', '#00ffff', '#ff0080', '#00ff88', '#ffff00'];
    
    for(let i = 0; i < 5; i++) {
        const circle = document.createElement('div');
        circle.className = 'fx neon-circle';
        circle.style.position = 'fixed';
        circle.style.width = (100 + Math.random() * 200) + 'px';
        circle.style.height = circle.style.width;
        circle.style.borderRadius = '50%';
        circle.style.border = `2px solid ${colors[i]}`;
        circle.style.boxShadow = `0 0 20px ${colors[i]}, inset 0 0 20px ${colors[i]}`;
        circle.style.left = Math.random() * 100 + 'vw';
        circle.style.top = Math.random() * 100 + 'vh';
        circle.style.opacity = '0.3';
        circle.style.pointerEvents = 'none';
        circle.style.zIndex = '5';
        
        document.body.appendChild(circle);
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è
        const moveCircle = () => {
            circle.animate([
                { transform: 'translate(0, 0) scale(1)' },
                { transform: `translate(${(Math.random()-0.5)*300}px, ${(Math.random()-0.5)*300}px) scale(${0.5 + Math.random()})` }
            ], {
                duration: 3000 + Math.random() * 2000,
                easing: 'ease-in-out',
                fill: 'forwards'
            }).onfinish = moveCircle;
        };
        moveCircle();
    }
    
    // –ù–µ–æ–Ω–æ–≤—ã–µ –ª–∏–Ω–∏–∏
    fxInterval = setInterval(() => {
        const line = document.createElement('div');
        line.className = 'fx neon-line';
        line.style.position = 'fixed';
        line.style.height = '2px';
        line.style.width = (50 + Math.random() * 150) + 'px';
        line.style.background = colors[Math.floor(Math.random() * colors.length)];
        line.style.boxShadow = `0 0 10px ${colors[Math.floor(Math.random() * colors.length)]}`;
        line.style.left = Math.random() * 100 + 'vw';
        line.style.top = Math.random() * 100 + 'vh';
        line.style.opacity = '0';
        line.style.pointerEvents = 'none';
        line.style.zIndex = '1000';
        
        document.body.appendChild(line);
        
        line.animate([
            { opacity: 0, transform: 'scaleX(0)' },
            { opacity: 1, transform: 'scaleX(1)' },
            { opacity: 0, transform: 'scaleX(0)' }
        ], { duration: 1000 }).onfinish = () => line.remove();
    }, 800);
}

function applyGalaxy() {
    clearFX();
    document.body.style.background = '#0a0015';
    const timer = document.getElementById('timer');
    timer.classList.add('galaxy-style');
    
    // –¢—É–º–∞–Ω–Ω–æ—Å—Ç—å
    const nebula = document.createElement('div');
    nebula.className = 'nebula fx';
    nebula.style.position = 'fixed';
    nebula.style.top = '0';
    nebula.style.left = '0';
    nebula.style.width = '100%';
    nebula.style.height = '100%';
    nebula.style.background = 'radial-gradient(ellipse at center, rgba(138,43,226,0.2) 0%, transparent 70%)';
    nebula.style.pointerEvents = 'none';
    nebula.style.zIndex = '1';
    nebula.style.animation = 'pulse 8s ease-in-out infinite';
    document.body.appendChild(nebula);
    
    // –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —á–∞—Å—Ç–∏—Ü—ã
    fxInterval = setInterval(() => {
        const particle = document.createElement('div');
        particle.className = 'fx galaxy-particle';
        particle.style.position = 'fixed';
        particle.style.width = (2 + Math.random() * 4) + 'px';
        particle.style.height = particle.style.width;
        particle.style.borderRadius = '50%';
        particle.style.background = ['#ffffff', '#b19cd9', '#ff69b4', '#00ffff'][Math.floor(Math.random() * 4)];
        particle.style.boxShadow = `0 0 ${5 + Math.random() * 10}px ${particle.style.background}`;
        particle.style.left = Math.random() * 100 + 'vw';
        particle.style.top = Math.random() * 100 + 'vh';
        particle.style.opacity = Math.random();
        particle.style.pointerEvents = 'none';
        particle.style.zIndex = '1000';
        
        document.body.appendChild(particle);
        
        particle.animate([
            { opacity: particle.style.opacity, transform: 'scale(1)' },
            { opacity: 0, transform: 'scale(0)' }
        ], { duration: 2000 + Math.random() * 3000 }).onfinish = () => particle.remove();
    }, 100);
    
    // –°–ø–∏—Ä–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
    fxInterval2 = setInterval(() => {
        const spiral = document.createElement('div');
        spiral.className = 'fx';
        spiral.textContent = '‚ú¶';
        spiral.style.position = 'fixed';
        spiral.style.left = '50%';
        spiral.style.top = '50%';
        spiral.style.fontSize = (10 + Math.random() * 20) + 'px';
        spiral.style.color = ['#9370db', '#ff69b4', '#00ffff'][Math.floor(Math.random() * 3)];
        spiral.style.pointerEvents = 'none';
        spiral.style.zIndex = '1000';
        
        document.body.appendChild(spiral);
        
        const angle = Math.random() * Math.PI * 2;
        const radius = 200 + Math.random() * 300;
        
        spiral.animate([
            { transform: 'translate(-50%, -50%) rotate(0deg)', opacity: 1 },
            { transform: `translate(calc(-50% + ${Math.cos(angle) * radius}px), calc(-50% + ${Math.sin(angle) * radius}px)) rotate(720deg)`, opacity: 0 }
        ], { duration: 3000 + Math.random() * 2000 }).onfinish = () => spiral.remove();
    }, 300);
}

function applyPixel() {
    clearFX();
    document.body.style.background = '#000';
    const timer = document.getElementById('timer');
    timer.classList.add('pixel', 'pixel-active');
    
    // –ü–∞–¥–∞—é—â–∏–µ –∑–µ–ª–µ–Ω—ã–µ –±–ª–æ–∫–∏ (–º–∞—Ç—Ä–∏—Ü–∞-—Å—Ç–∏–ª—å)
    fxInterval = setInterval(() => {
        const el = document.createElement('div');
        el.className = 'fx pixel-particle';
        el.textContent = '‚ñ†';
        el.style.position = 'fixed';
        el.style.left = Math.random() * 100 + 'vw';
        el.style.top = '-20px';
        el.style.color = '#00ff00';
        el.style.fontSize = (10 + Math.random() * 15) + 'px';
        el.style.textShadow = '0 0 5px #00ff00';
        el.style.zIndex = '1000';
        el.style.pointerEvents = 'none';
        
        document.body.appendChild(el);
        
        el.animate([
            { transform: 'translateY(0)', opacity: 1 },
            { transform: 'translateY(110vh)', opacity: 0.3 }
        ], { duration: 2000 + Math.random() * 2000 }).onfinish = () => el.remove();
    }, 150);
    
    // –≠—Ñ—Ñ–µ–∫—Ç –ø—É–ª—å—Å–∞—Ü–∏–∏ —Ç–∞–π–º–µ—Ä–∞
    let scaleUp = true;
    fxInterval2 = setInterval(() => {
        if(timer) {
            const scale = scaleUp ? 1.1 : 0.9;
            timer.style.transform = `scale(${scale})`;
            timer.style.transition = 'transform 0.3s ease';
            scaleUp = !scaleUp;
        }
    }, 300);
}

function applyStarfield() {
    clearFX();
    document.body.style.background = '#000000';
    const timer = document.getElementById('timer');
    timer.classList.add('starfield-style');
    
    // –°—Ç–∞—Ç–∏—á–Ω—ã–µ –∑–≤–µ–∑–¥—ã
    for(let i = 0; i < 100; i++) {
        const star = document.createElement('div');
        star.className = 'fx star';
        star.style.position = 'fixed';
        star.style.width = (1 + Math.random() * 2) + 'px';
        star.style.height = star.style.width;
        star.style.borderRadius = '50%';
        star.style.background = '#ffffff';
        star.style.left = Math.random() * 100 + 'vw';
        star.style.top = Math.random() * 100 + 'vh';
        star.style.opacity = Math.random();
        star.style.pointerEvents = 'none';
        star.style.zIndex = '1';
        star.style.animation = `twinkle ${2 + Math.random() * 3}s ease-in-out infinite`;
        
        document.body.appendChild(star);
    }
    
    // –ö–æ–º–µ—Ç—ã
    fxInterval = setInterval(() => {
        const comet = document.createElement('div');
        comet.className = 'fx comet';
        comet.style.position = 'fixed';
        comet.style.width = '3px';
        comet.style.height = '3px';
        comet.style.borderRadius = '50%';
        comet.style.background = '#fff';
        comet.style.boxShadow = '0 0 10px #fff, 0 0 20px #4af';
        comet.style.left = Math.random() * 100 + 'vw';
        comet.style.top = '-20px';
        comet.style.pointerEvents = 'none';
        comet.style.zIndex = '1000';
        
        document.body.appendChild(comet);
        
        const endX = (Math.random() - 0.5) * 500;
        
        comet.animate([
            { transform: 'translate(0, 0)', opacity: 1 },
            { transform: `translate(${endX}px, 110vh)`, opacity: 0 }
        ], { 
            duration: 1500 + Math.random() * 1000,
            easing: 'ease-in'
        }).onfinish = () => comet.remove();
    }, 3000);
    
    // –ü—Ä–æ–ª–µ—Ç–∞—é—â–∏–µ –æ–±—ä–µ–∫—Ç—ã
    fxInterval2 = setInterval(() => {
        const obj = document.createElement('div');
        obj.className = 'fx';
        obj.textContent = ['üõ∏', 'üåü', 'üí´', '‚òÑÔ∏è'][Math.floor(Math.random() * 4)];
        obj.style.position = 'fixed';
        obj.style.left = '-50px';
        obj.style.top = Math.random() * 100 + 'vh';
        obj.style.fontSize = (20 + Math.random() * 20) + 'px';
        obj.style.pointerEvents = 'none';
        obj.style.zIndex = '1000';
        
        document.body.appendChild(obj);
        
        obj.animate([
            { transform: 'translateX(0) rotate(0deg)', opacity: 0.8 },
            { transform: `translateX(calc(100vw + 100px)) rotate(${Math.random() * 360}deg)`, opacity: 0 }
        ], { duration: 3000 + Math.random() * 2000 }).onfinish = () => obj.remove();
    }, 5000);
}

function applySorrow() {
    clearFX();
    document.body.style.background = '#1a1a2e';
    const timer = document.getElementById('timer');
    timer.className = 'sorrow-style';
    
    // –î–æ–∂–¥—å
    fxInterval = setInterval(() => {
        const drop = document.createElement('div');
        drop.className = 'fx rain-drop';
        drop.style.position = 'fixed';
        drop.style.width = '2px';
        drop.style.height = (10 + Math.random() * 20) + 'px';
        drop.style.background = 'linear-gradient(transparent, rgba(174, 194, 224, 0.8))';
        drop.style.left = Math.random() * 100 + 'vw';
        drop.style.top = '-30px';
        drop.style.pointerEvents = 'none';
        drop.style.zIndex = '1000';
        
        document.body.appendChild(drop);
        
        drop.animate([
            { transform: 'translateY(0)' },
            { transform: 'translateY(110vh)' }
        ], { 
            duration: 500 + Math.random() * 500,
            easing: 'linear'
        }).onfinish = () => drop.remove();
    }, 50);
    
    // –ú–æ–ª–Ω–∏–∏
    fxInterval2 = setInterval(() => {
        const lightning = document.createElement('div');
        lightning.className = 'fx lightning';
        lightning.style.position = 'fixed';
        lightning.style.top = '0';
        lightning.style.left = '0';
        lightning.style.width = '100%';
        lightning.style.height = '100%';
        lightning.style.background = 'rgba(255, 255, 255, 0.8)';
        lightning.style.pointerEvents = 'none';
        lightning.style.zIndex = '9999';
        
        document.body.appendChild(lightning);
        
        lightning.animate([
            { opacity: 0 },
            { opacity: 1 },
            { opacity: 0 },
            { opacity: 0.6 },
            { opacity: 0 }
        ], { 
            duration: 200,
            easing: 'steps(5)'
        }).onfinish = () => lightning.remove();
    }, 5000 + Math.random() * 10000);
}

// –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º KooKoo
// –û–±–Ω–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é applyKooKoo:
function applyKooKoo() {
    clearFX();
    
    document.body.style.background = '#050010';

    // –ü—Ä—è—á–µ–º –¢–û–õ–¨–ö–û –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–π–º–µ—Ä, –ù–ï –º—É–∑—ã–∫–∞–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É
    const mainTimer = document.getElementById("timer");
    if (mainTimer) mainTimer.style.display = "none";

    // –°–æ–∑–¥–∞–µ–º KooKoo –æ–±–µ—Ä—Ç–∫—É
    let wrap = document.getElementById("kookoo-wrapper");
    if (!wrap) {
        wrap = document.createElement("div");
        wrap.id = "kookoo-wrapper";
        wrap.className = "fx";
        wrap.innerHTML = `
            <div class="kookoo-content">
                <img class="kookoo-gif" id="kookoo-gif" src="Kookoo_Clock.webp" alt="kookoo">
                <div class="kookoo-timer" id="kookoo-time"></div>
            </div>
        `;
        
        // –í—Å—Ç–∞–≤–ª—è–µ–º –≤ main, –ü–ï–†–ï–î –º—É–∑—ã–∫–∞–ª—å–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π (–Ω–µ –ø–æ—Å–ª–µ!)
        const mainContent = document.getElementById('main-content-wrapper');
        const musicBlock = mainContent.querySelector('div[style*="text-align:center"]');
        
        if (mainContent && musicBlock) {
            mainContent.insertBefore(wrap, musicBlock);
        } else if (mainContent) {
            mainContent.insertBefore(wrap, mainContent.firstChild);
        }
    } else {
        wrap.style.display = "block";
        const gif = document.getElementById("kookoo-gif");
        if(gif) gif.src = "Kookoo_Clock.webp";
    }

    kookooState = "count";
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
    console.log('Starting KooKoo timer...');
    updateKookooOverlay();
    
    if (fxInterval2) {
        clearInterval(fxInterval2);
    }
    
    fxInterval2 = setInterval(() => {
        updateKookooOverlay();
    }, 1000);
}
// –û–±–Ω–æ–≤–∏—Ç–µ clearFX —á—Ç–æ–±—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø–ª–µ–µ—Ä:

function clearFX() {
    console.log('Clearing FX for skin switch');
    
    // –£–¥–∞–ª—è–µ–º –¢–û–õ–¨–ö–û —ç—Ñ—Ñ–µ–∫—Ç—ã —Å–∫–∏–Ω–æ–≤, –ù–ï –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —É–∫—Ä–∞—à–µ–Ω–∏—è
    document.querySelectorAll('.fx:not(.permanent-snow):not(.corner-snow):not(.side-star):not(.side-light):not(.ambient-confetti)').forEach(n => n.remove());
    
    // –£–¥–∞–ª—è–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–∫–∏–Ω–æ–≤
    document.querySelectorAll('.lightning-flash, .neon-circle, .neon-line, .minecraft-block, .sakura, .fire-particle, .rain-drop, .lightning, .comet, .star, .galaxy-particle, .pixel-particle, .kookoo-wrapper').forEach(n => n.remove());

    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
    if (fxInterval) { clearInterval(fxInterval); fxInterval = null; }
    if (fxInterval2) { clearInterval(fxInterval2); fxInterval2 = null; }

    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∏–ª–∏ body (–ù–ï —Ç—Ä–æ–≥–∞–µ–º –∫–ª–∞—Å—Å—ã –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö —É–∫—Ä–∞—à–µ–Ω–∏–π)
    const classList = document.body.className.split(' ');
    const permanentClasses = classList.filter(c => 
        c === 'edit-mode-active' || 
        c.includes('permanent') || 
        c.includes('decoration')
    );
    document.body.className = permanentClasses.join(' ');
    
    document.body.style.background = '';
    document.body.style.overflow = '';
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å –µ—Å–ª–∏ –±—ã–ª —Å–∫—Ä—ã—Ç
    const calendar = document.getElementById('calendar');
    if (calendar) calendar.style.display = '';
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
    const timer = document.getElementById('timer');
    if (timer) {
        timer.className = '';
        timer.style.display = ''; 
        timer.style.transform = '';
        timer.style.transition = '';
        
        // –£–¥–∞–ª—è–µ–º overlay —Å–Ω–µ–≥–∞ —Å —Ç–∞–π–º–µ—Ä–∞ –µ—Å–ª–∏ –æ–Ω –æ—Ç —Å–∫–∏–Ω–∞ (–Ω–µ –æ—Ç —É–∫—Ä–∞—à–µ–Ω–∏—è)
        const overlay = timer.querySelector('.timer-snow-overlay:not(.permanent)');
        if (overlay) overlay.remove();
    }
    
    // –£–¥–∞–ª—è–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–∫–∏–Ω–æ–≤
    document.querySelectorAll('.neon-overlay, .firestorm-overlay, .minecraft-wrap, .creeper-silhouette, .starfield-nebula, .space-planet').forEach(n => n.remove());
    
    // –ù–ï —É–¥–∞–ª—è–µ–º –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —É–∫—Ä–∞—à–µ–Ω–∏—è:
    // - .header-tree
    // - .has-garland –Ω–∞ .day
    // - .permanent-snow
    // - .corner-snow
    // - .header-garland
    // - .side-star
    // - .festive-border
    // - .ambient-confetti
    // - .side-light
}

function checkKooKooState(isFinished) {
    const gif = document.getElementById("kookoo-gif");
    if (!gif) return;

    if (isFinished) {
        if (kookooState === "count") {
            gif.src = "Kookoo_Clock_end.webp";
            kookooState = "finish";
            setTimeout(() => {
                gif.src = "Kookoo_idle.png";
                kookooState = "idle";
            }, 2000);
        }
    } else {
        if (kookooState !== "count") {
            gif.src = "Kookoo_Clock.webp";
            kookooState = "count";
        }
    }
}

// –û–±–Ω–æ–≤–∏—Ç–µ updateKookooOverlay —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
function updateKookooOverlay() {
    const t = document.getElementById("kookoo-time");
    
    if (!t) {
        console.log('KooKoo timer element not found');
        return;
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∂–∏–º (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π)
    if (currentSkin !== 'kookoo') {
        console.log('Not in KooKoo mode, stopping timer');
        if (fxInterval2) {
            clearInterval(fxInterval2);
            fxInterval2 = null;
        }
        return;
    }
    
    const now = new Date();
    const target = computeTarget();
    const diff = target - now;
    
    if(diff <= 0) {
        t.textContent = '0';
        checkKooKooState(true);
    } else {
        const totalSeconds = Math.floor(diff / 1000);
        t.textContent = totalSeconds.toLocaleString('ru-RU');
        checkKooKooState(false);
    }
}

// --- –°–ï–¢–ï–í–ê–Ø –õ–û–ì–ò–ö–ê –ö–õ–ò–ö–û–í (FIREBASE) ---

// 1. –ü—Ä–∏–µ–º –∫–ª–∏–∫–æ–≤ –æ—Ç –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–æ–∫–æ–≤
db.ref('live_clicks').limitToLast(1).on('child_added', (snapshot) => {
    const data = snapshot.val();
    if (data && data.time > Date.now() - 3000) {
        // –≠—Ñ—Ñ–µ–∫—Ç –≤—Å–ø—ã—à–∫–∏ –≤ –º–µ—Å—Ç–µ –∫–ª–∏–∫–∞
        const p = document.createElement('div');
        p.className = 'fx click-sparkle';
        p.style.cssText = `position: fixed; left:${data.x}px; top:${data.y}px; width: 20px; height: 20px; background: radial-gradient(circle, #fff, transparent); border-radius: 50%; pointer-events: none; z-index: 10000; animation: sparkle 0.6s ease-out;`;
        document.body.appendChild(p);
        setTimeout(() => p.remove(), 600);

        // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 4: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∫–ª–∏–∫–µ –¥—Ä—É–≥–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ showMusicNotice
        if (data.sender !== userName) {
            showMusicNotice(`${data.sender} –±–∞—Ö–Ω—É–ª —Å–∞–ª—é—Ç!`);
        }
    }
});

// 2. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–≤–æ–µ–≥–æ –∫–ª–∏–∫–∞
window.addEventListener('mousedown', (e) => {
    // –ù–µ —Å—á–∏—Ç–∞–µ–º –∫–ª–∏–∫–∏ –ø–æ –∫–Ω–æ–ø–∫–∞–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    if (e.target.closest('#menu') || e.target.closest('.music-player') || e.target.closest('.decoration-panel') || e.target.closest('button')) return;
    
    const modal = document.getElementById('name-modal');
    if (modal && modal.style.display !== 'none') return;

    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –±–∞–∑—É
    db.ref('live_clicks').push({
        x: e.clientX, 
        y: e.clientY, 
        sender: userName, 
        time: Date.now()
    });

    // –ü—Ä–æ–≥—Ä–µ—Å—Å
    db.ref('global_progress').transaction((count) => (count || 0) + 1);
});

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è (–µ—Å–ª–∏ –æ–Ω–∞ —É –≤–∞—Å –µ—Å—Ç—å)
function startPresence(name) {
    const userRef = db.ref('online_users/' + Date.now() + '_' + Math.random().toString(36).substr(2, 9));
    userRef.set({ name: name, timestamp: Date.now() });
    userRef.onDisconnect().remove();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    db.ref('online_users').on('value', (snapshot) => {
        const users = snapshot.val();
        const onlineList = document.getElementById('online-list');
        if (onlineList && users) {
            const count = Object.keys(users).length;
            onlineList.textContent = `üë• ${count} –æ–Ω–ª–∞–π–Ω`;
        }
    });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–∫—Ä–∞—à–µ–Ω–∏–π (–µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —ç—Ç–∞ –ª–æ–≥–∏–∫–∞)
function clickDecor(type) {
    const ref = db.ref('decorations/' + type);
    ref.transaction((count) => {
        const newCount = (count || 0) + 1;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º UI
        if (type === 'tree') {
            const max = 500;
            document.getElementById('tree-count').textContent = `${newCount}/${max}`;
            const bar = document.getElementById('bar-tree');
            if (bar) bar.style.width = Math.min(100, (newCount / max) * 100) + '%';
        } else if (type === 'firework') {
            const max = 50;
            document.getElementById('firework-count').textContent = `${newCount}/${max}`;
            const bar = document.getElementById('bar-firework');
            if (bar) bar.style.width = Math.min(100, (newCount / max) * 100) + '%';
            
            // –≠—Ñ—Ñ–µ–∫—Ç —Å–∞–ª—é—Ç–∞
            if (newCount >= max) {
                launchFirework();
            }
        }
        
        return newCount;
    });
}

// –≠—Ñ—Ñ–µ–∫—Ç —Å–∞–ª—é—Ç–∞
function launchFirework() {
    const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
    const centerX = window.innerWidth / 2;
    const centerY = window.innerHeight / 2;
    
    for (let i = 0; i < 30; i++) {
        setTimeout(() => {
            const particle = document.createElement('div');
            particle.className = 'fx firework-particle';
            particle.style.position = 'fixed';
            particle.style.left = centerX + 'px';
            particle.style.top = centerY + 'px';
            particle.style.width = '4px';
            particle.style.height = '4px';
            particle.style.borderRadius = '50%';
            particle.style.background = colors[Math.floor(Math.random() * colors.length)];
            particle.style.pointerEvents = 'none';
            particle.style.zIndex = '10000';
            
            document.body.appendChild(particle);
            
            const angle = (Math.PI * 2 * i) / 30;
            const velocity = 150 + Math.random() * 100;
            const tx = Math.cos(angle) * velocity;
            const ty = Math.sin(angle) * velocity;
            
            particle.animate([
                { transform: 'translate(0, 0)', opacity: 1 },
                { transform: `translate(${tx}px, ${ty}px)`, opacity: 0 }
            ], {
                duration: 1000 + Math.random() * 500,
                easing: 'cubic-bezier(0, 0.5, 0.5, 1)'
            }).onfinish = () => particle.remove();
        }, i * 20);
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    showMusicNotice('üéÜ –ú–µ–≥–∞-—Å–∞–ª—é—Ç –∑–∞–ø—É—â–µ–Ω! üéÜ');
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', () => {
    setSkin('default');
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ sparkle –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    if (!document.querySelector('#sparkle-keyframes')) {
        const style = document.createElement('style');
        style.id = 'sparkle-keyframes';
        style.textContent = `
            @keyframes sparkle {
                0% { transform: scale(0); opacity: 1; }
                50% { transform: scale(1.5); opacity: 0.8; }
                100% { transform: scale(0); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    }
});

// –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö
function showActionNotice(text, color = '#4caf50') {
    const notice = document.getElementById('action-notice');
    if (!notice) return;
    
    notice.textContent = text;
    notice.style.background = `rgba(${color === '#4caf50' ? '76, 175, 80' : color === '#ff5722' ? '255, 87, 34' : '233, 30, 99'}, 0.95)`;
    notice.classList.add('active');
    
    setTimeout(() => {
        notice.classList.remove('active');
    }, 3000);
}

// ============================================
// –ü–û–õ–ù–´–ô –ö–û–î –í–°–ï–• –§–£–ù–ö–¶–ò–ô –£–ö–†–ê–®–ï–ù–ò–ô
// –ó–∞–º–µ–Ω–∏—Ç–µ –í–°–ï —Å—Ç–∞—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–∫—Ä–∞—à–µ–Ω–∏–π —ç—Ç–∏–º –±–ª–æ–∫–æ–º
// ============================================

// –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö
function showActionNotice(text, color = '#4caf50') {
    const notice = document.getElementById('action-notice');
    if (!notice) return;
    
    notice.textContent = text;
    notice.style.background = `rgba(${color === '#4caf50' ? '76, 175, 80' : color === '#ff5722' ? '255, 87, 34' : color === '#e91e63' ? '233, 30, 99' : color === '#9c27b0' ? '156, 39, 176' : color === '#ffeb3b' ? '255, 235, 59' : color === '#ffc107' ? '255, 193, 7' : '3, 169, 244'}, 0.95)`;
    notice.classList.add('active');
    
    setTimeout(() => {
        notice.classList.remove('active');
    }, 3000);
}

// ============================================
// –ü–ê–°–°–ò–í–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø
// ============================================

function clickDecor(type) {
    const ref = db.ref('decorations/' + type);
    ref.transaction((count) => {
        const newCount = (count || 0) + 1;
        
        const configs = {
            'tree': { max: 100, name: '–µ–ª–∫–µ', activate: activateTreeDecoration },
            'garland': { max: 150, name: '–≥–∏—Ä–ª—è–Ω–¥–∞–º', activate: activateGarlandDecoration },
            'snow': { max: 200, name: '—Å–Ω–µ–≥—É', activate: activateSnowDecoration },
            'corners': { max: 120, name: '—Å–Ω–µ–∂–∏–Ω–∫–∞–º', activate: activateCornerSnow },
            'header-garland': { max: 180, name: '–≥–∏—Ä–ª—è–Ω–¥–µ', activate: activateHeaderGarland },
            'stars': { max: 140, name: '–∑–≤–µ–∑–¥–∞–º', activate: activateSideStars },
            'border': { max: 160, name: '—Ä–∞–º–∫–µ', activate: activateFestiveBorder },
            'ambient-confetti': { max: 220, name: '–∫–æ–Ω—Ñ–µ—Ç—Ç–∏', activate: activateAmbientConfetti },
            'side-lights': { max: 190, name: '–æ–≥–æ–Ω—å–∫–∞–º', activate: activateSideLights },
            'timer-snow': { max: 170, name: '—Å–Ω–µ–≥—É –Ω–∞ —Ç–∞–π–º–µ—Ä–µ', activate: activateTimerSnow }
        };
        
        const config = configs[type];
        if (!config) return newCount;
        
        const countId = type + '-count';
        const barId = 'bar-' + type;
        const slotId = 'slot-' + type;
        
        document.getElementById(countId).textContent = `${newCount}/${config.max}`;
        const bar = document.getElementById(barId);
        if (bar) bar.style.width = Math.min(100, (newCount / config.max) * 100) + '%';
        
        if (newCount >= config.max) {
            config.activate();
            const slot = document.getElementById(slotId);
            if (slot) slot.classList.add('completed');
            showActionNotice(`‚ú® ${config.name} –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ!`);
        } else {
            showActionNotice(`+1 –∫ ${config.name} (${newCount}/${config.max})`);
        }
        
        return newCount;
    });
}

// –§—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–∞—Å—Å–∏–≤–Ω—ã—Ö —É–∫—Ä–∞—à–µ–Ω–∏–π:

function activateTreeDecoration() {
    const header = document.querySelector('header .nav-group');
    if (!header || document.querySelector('.header-tree')) return;
    
    const tree = document.createElement('span');
    tree.className = 'header-tree';
    tree.textContent = 'üéÑ';
    header.insertBefore(tree, header.firstChild);
}

function activateGarlandDecoration() {
    const days = document.querySelectorAll('.day');
    days.forEach(day => {
        day.classList.add('has-garland');
    });
}

function activateSnowDecoration() {
    for (let i = 0; i < 20; i++) {
        setTimeout(() => {
            const snow = document.createElement('div');
            snow.className = 'permanent-snow';
            snow.textContent = '‚ùÑ';
            snow.style.left = Math.random() * 100 + 'vw';
            snow.style.animationDelay = Math.random() * 5 + 's';
            snow.style.animationDuration = (10 + Math.random() * 10) + 's';
            document.body.appendChild(snow);
        }, i * 200);
    }
}

function activateCornerSnow() {
    if (document.querySelector('.corner-snow')) return;
    
    const positions = [
        { top: '70px', left: '10px' },
        { top: '70px', right: '10px' },
        { bottom: '50px', left: '10px' },
        { bottom: '50px', right: '10px' }
    ];
    
    positions.forEach((pos, i) => {
        const snow = document.createElement('div');
        snow.className = 'corner-snow';
        snow.textContent = '‚ùÑÔ∏è';
        Object.assign(snow.style, pos);
        snow.style.animationDelay = (i * 0.5) + 's';
        document.body.appendChild(snow);
    });
}

function activateHeaderGarland() {
    const header = document.querySelector('header');
    if (!header || document.querySelector('.header-garland')) return;
    
    const garland = document.createElement('div');
    garland.className = 'header-garland';
    header.appendChild(garland);
}

function activateSideStars() {
    if (document.querySelector('.side-star')) return;
    
    for (let i = 0; i < 6; i++) {
        const star = document.createElement('div');
        star.className = 'side-star';
        star.textContent = '‚≠ê';
        star.style.top = (15 + i * 15) + 'vh';
        star.style.left = i % 2 === 0 ? '10px' : 'auto';
        star.style.right = i % 2 === 1 ? '10px' : 'auto';
        star.style.animationDelay = (i * 0.3) + 's';
        document.body.appendChild(star);
    }
}

function activateFestiveBorder() {
    if (document.querySelector('.festive-border')) return;
    
    const borderTop = document.createElement('div');
    borderTop.className = 'festive-border top';
    document.body.appendChild(borderTop);
    
    const borderBottom = document.createElement('div');
    borderBottom.className = 'festive-border bottom';
    document.body.appendChild(borderBottom);
}

function activateAmbientConfetti() {
    if (document.querySelectorAll('.ambient-confetti').length > 0) return;
    
    const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#ffa500'];
    for (let i = 0; i < 15; i++) {
        setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'ambient-confetti';
            confetti.style.left = Math.random() * 100 + 'vw';
            confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.animationDelay = Math.random() * 5 + 's';
            confetti.style.animationDuration = (15 + Math.random() * 10) + 's';
            document.body.appendChild(confetti);
        }, i * 300);
    }
}

function activateSideLights() {
    if (document.querySelector('.side-light')) return;
    
    const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff'];
    for (let i = 0; i < 10; i++) {
        const light = document.createElement('div');
        light.className = 'side-light';
        light.style.top = (10 + i * 9) + 'vh';
        light.style.left = i % 2 === 0 ? '5px' : 'auto';
        light.style.right = i % 2 === 1 ? '5px' : 'auto';
        light.style.background = colors[i % colors.length];
        light.style.color = colors[i % colors.length];
        light.style.animationDelay = (i * 0.2) + 's';
        document.body.appendChild(light);
    }
}

function activateTimerSnow() {
    const timer = document.getElementById('timer');
    if (!timer || timer.querySelector('.timer-snow-overlay')) return;
    
    const overlay = document.createElement('div');
    overlay.className = 'timer-snow-overlay';
    
    for (let i = 0; i < 10; i++) {
        const particle = document.createElement('div');
        particle.className = 'timer-snow-particle';
        particle.textContent = '‚ùÑ';
        particle.style.left = (i * 10) + '%';
        particle.style.animationDelay = (i * 0.3) + 's';
        overlay.appendChild(particle);
    }
    
    timer.style.position = 'relative';
    timer.appendChild(overlay);
}

// ============================================
// –ú–ù–û–ì–û–†–ê–ó–û–í–´–ï –≠–§–§–ï–ö–¢–´
// ============================================

// ============================================
// –û–ë–ù–û–í–õ–ï–ù–ù–´–ï –ú–ù–û–ì–û–†–ê–ó–û–í–´–ï –≠–§–§–ï–ö–¢–´ (–°–ò–ù–•–†–û–ù–ù–´–ï)
// ============================================

function clickMultiUse(type) {
    const ref = db.ref('multi_use/' + type);
    const triggerRef = db.ref('triggers/' + type); // –û—Ç–¥–µ–ª—å–Ω–∞—è –≤–µ—Ç–∫–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–æ–±—ã—Ç–∏–π

    ref.transaction((count) => {
        const configs = {
            'firework': { max: 30, name: '—Å–∞–ª—é—Ç–∞', color: '#ff5722' },
            'gifts': { max: 25, name: '–ø–æ–¥–∞—Ä–∫–æ–≤', color: '#e91e63' },
            'confetti': { max: 20, name: '–∫–æ–Ω—Ñ–µ—Ç—Ç–∏', color: '#9c27b0' },
            'lightning': { max: 35, name: '–º–æ–ª–Ω–∏–π', color: '#ffeb3b' },
            'starfall': { max: 28, name: '–∑–≤–µ–∑–¥–æ–ø–∞–¥–∞', color: '#ffc107' },
            'balloons': { max: 22, name: '—à–∞—Ä–æ–≤', color: '#03a9f4' }
        };

        const config = configs[type];
        const newCount = (count || 0) + 1;

        if (newCount >= config.max) {
            // –ï—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–ª–∏ –º–∞–∫—Å–∏–º—É–º–∞:
            // 1. –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –±–∞–∑—É —Å–∏–≥–Ω–∞–ª –∑–∞–ø—É—Å–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º
            triggerRef.set(firebase.database.ServerValue.TIMESTAMP);
            
            // 2. –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –≤ 0
            return 0; 
        }

        return newCount;
    });
}

// –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è, —á—Ç–æ–±—ã –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
let initialLoad = true;

// –°–õ–£–®–ê–¢–ï–õ–¨ –¢–†–ò–ì–ì–ï–†–û–í (–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫)
db.ref('triggers').on('value', (snapshot) => {
    const data = snapshot.val() || {};
    
    // –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å–∞–π—Ç–∞ ‚Äî –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ–º –≤—Å—ë —Å—Ä–∞–∑—É
    if (initialLoad) {
        initialLoad = false;
        return;
    }

    const configs = {
        'firework': { name: '—Å–∞–ª—é—Ç–∞', launch: launchFirework, color: '#ff5722' },
        'gifts': { name: '–ø–æ–¥–∞—Ä–∫–æ–≤', launch: launchGiftRain, color: '#e91e63' },
        'confetti': { name: '–∫–æ–Ω—Ñ–µ—Ç—Ç–∏', launch: launchConfetti, color: '#9c27b0' },
        'lightning': { name: '–º–æ–ª–Ω–∏–π', launch: launchLightning, color: '#ffeb3b' },
        'starfall': { name: '–∑–≤–µ–∑–¥–æ–ø–∞–¥–∞', launch: launchStarfall, color: '#ffc107' },
        'balloons': { name: '—à–∞—Ä–æ–≤', launch: launchBalloons, color: '#03a9f4' }
    };

    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–æ–µ –∏–º–µ–Ω–Ω–æ —Å–æ–±—ã—Ç–∏–µ –æ–±–Ω–æ–≤–∏–ª–æ—Å—å (–ø–æ–ª—É—á–∏–ª–æ –Ω–æ–≤—ã–π Timestamp)
    // Firebase `.on('value')` —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–æ–≥–¥–∞ –ª—é–±–æ–π —Ç—Ä–∏–≥–≥–µ—Ä –æ–±–Ω–æ–≤–∏—Ç—Å—è
    // –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–æ, —á—Ç–æ –ø—Ä–∏—à–ª–æ
});

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤–µ—à–∞–µ–º —Å–ª—É—à–∞—Ç–µ–ª–∏ –Ω–∞ –∫–∞–∂–¥–æ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
const eventTypes = ['firework', 'gifts', 'confetti', 'lightning', 'starfall', 'balloons'];
eventTypes.forEach(type => {
    db.ref('triggers/' + type).on('value', (snapshot) => {
        if (initialLoad) return;
        
        const configs = {
            'firework': { name: '–°–∞–ª—é—Ç', launch: launchFirework, color: '#ff5722' },
            'gifts': { name: '–ü–æ–¥–∞—Ä–∫–∏', launch: launchGiftRain, color: '#e91e63' },
            'confetti': { name: '–ö–æ–Ω—Ñ–µ—Ç—Ç–∏', launch: launchConfetti, color: '#9c27b0' },
            'lightning': { name: '–ú–æ–ª–Ω–∏–∏', launch: launchLightning, color: '#ffeb3b' },
            'starfall': { name: '–ó–≤–µ–∑–¥–æ–ø–∞–¥', launch: launchStarfall, color: '#ffc107' },
            'balloons': { name: '–®–∞—Ä—ã', launch: launchBalloons, color: '#03a9f4' }
        };

        const config = configs[type];
        if (config) {
            config.launch();
            showActionNotice(`${config.name} –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤—Å–µ—Ö!`, config.color);
        }
    });
});

// –û–ë–ù–û–í–õ–ï–ù–ò–ï –ë–ê–†–û–í (–ü—Ä–æ–≥—Ä–µ—Å—Å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è)
// –≠—Ç—É —á–∞—Å—Ç—å –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª–æ—Å–æ–∫ –∏ —Ü–∏—Ñ—Ä
db.ref('multi_use').on('value', (snapshot) => {
    const data = snapshot.val() || {};
    const multiConfigs = {
        'firework': 30, 'gifts': 25, 'confetti': 20,
        'lightning': 35, 'starfall': 28, 'balloons': 22
    };

    Object.keys(multiConfigs).forEach(type => {
        const max = multiConfigs[type];
        const count = data[type] || 0;
        
        const countEl = document.getElementById(type + '-ready');
        const bar = document.getElementById('bar-' + type + '-ready');
        
        if (countEl) countEl.textContent = `${count}/${max}`;
        if (bar) bar.style.width = Math.min(100, (count / max) * 100) + '%';
    });
});
    const ref = db.ref('multi_use/' + type);
    
    ref.transaction((count) => {
        const newCount = (count || 0) + 1;
        
        const configs = {
            'firework': { max: 30, name: '—Å–∞–ª—é—Ç–∞', launch: launchFirework, color: '#ff5722' },
            'gifts': { max: 25, name: '–ø–æ–¥–∞—Ä–∫–æ–≤', launch: launchGiftRain, color: '#e91e63' },
            'confetti': { max: 20, name: '–∫–æ–Ω—Ñ–µ—Ç—Ç–∏', launch: launchConfetti, color: '#9c27b0' },
            'lightning': { max: 35, name: '–º–æ–ª–Ω–∏–π', launch: launchLightning, color: '#ffeb3b' },
            'starfall': { max: 28, name: '–∑–≤–µ–∑–¥–æ–ø–∞–¥–∞', launch: launchStarfall, color: '#ffc107' },
            'balloons': { max: 22, name: '—à–∞—Ä–æ–≤', launch: launchBalloons, color: '#03a9f4' }
        };
        
        const config = configs[type];
        if (!config) return newCount;
        
        const countId = type + '-ready';
        const barId = 'bar-' + type + '-ready';
        
        document.getElementById(countId).textContent = `${newCount}/${config.max}`;
        const bar = document.getElementById(barId);
        if (bar) bar.style.width = Math.min(100, (newCount / config.max) * 100) + '%';
        
        if (newCount >= config.max) {
            config.launch();
            showActionNotice(`${config.name} –∑–∞–ø—É—â–µ–Ω–æ!`, config.color);
            setTimeout(() => {
                ref.set(0);
                document.getElementById(countId).textContent = `0/${config.max}`;
                if (bar) bar.style.width = '0%';
            }, 500);
            return 0;
        } else {
            showActionNotice(`+1 –∑–∞—Ä—è–¥ ${config.name} (${newCount}/${config.max})`);
        }
        
        return newCount;
    });


// –§—É–Ω–∫—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞ –º–Ω–æ–≥–æ—Ä–∞–∑–æ–≤—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤:

function launchFirework() {
    setTimeout(() => {
        for (let burst = 0; burst < 3; burst++) {
            setTimeout(() => {
                const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
                const x = 20 + Math.random() * 60;
                const y = 20 + Math.random() * 40;
                
                for (let i = 0; i < 40; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'firework-burst';
                    particle.style.left = x + 'vw';
                    particle.style.top = y + 'vh';
                    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                    document.body.appendChild(particle);
                    
                    const angle = (Math.PI * 2 * i) / 40;
                    const velocity = 100 + Math.random() * 100;
                    const tx = Math.cos(angle) * velocity;
                    const ty = Math.sin(angle) * velocity;
                    
                    particle.animate([
                        { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                        { transform: `translate(${tx}px, ${ty}px) scale(0)`, opacity: 0 }
                    ], {
                        duration: 1000 + Math.random() * 500,
                        easing: 'cubic-bezier(0, 0.5, 0.5, 1)'
                    }).onfinish = () => particle.remove();
                }
            }, burst * 1000);
        }
    }, 3000);
}

function launchGiftRain() {
    const gifts = ['üéÅ', 'üéÄ', 'üéä'];
    for (let i = 0; i < 30; i++) {
        setTimeout(() => {
            const gift = document.createElement('div');
            gift.className = 'gift-rain';
            gift.textContent = gifts[Math.floor(Math.random() * gifts.length)];
            gift.style.left = Math.random() * 100 + 'vw';
            gift.style.animationDelay = '0s';
            gift.style.animationDuration = (2 + Math.random()) + 's';
            document.body.appendChild(gift);
            
            setTimeout(() => gift.remove(), 3000);
        }, i * 100);
    }
}

function launchConfetti() {
    const confettiColors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#ffa500'];
    for (let i = 0; i < 50; i++) {
        setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'firework-burst';
            confetti.style.left = Math.random() * 100 + 'vw';
            confetti.style.top = '-20px';
            confetti.style.width = (5 + Math.random() * 10) + 'px';
            confetti.style.height = (5 + Math.random() * 10) + 'px';
            confetti.style.background = confettiColors[Math.floor(Math.random() * confettiColors.length)];
            document.body.appendChild(confetti);
            
            confetti.animate([
                { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                { transform: `translateY(110vh) rotate(${Math.random() * 720}deg)`, opacity: 0 }
            ], {
                duration: 3000 + Math.random() * 2000,
                easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
            }).onfinish = () => confetti.remove();
        }, i * 50);
    }
}

function launchLightning() {
    for (let i = 0; i < 5; i++) {
        setTimeout(() => {
            const flash = document.createElement('div');
            flash.style.cssText = `
                position: fixed; inset: 0; background: rgba(255,255,255,0.8);
                pointer-events: none; z-index: 9999;
            `;
            document.body.appendChild(flash);
            
            flash.animate([
                { opacity: 0 },
                { opacity: 1 },
                { opacity: 0 },
                { opacity: 0.6 },
                { opacity: 0 }
            ], { duration: 150 }).onfinish = () => flash.remove();
        }, i * 800);
    }
}

function launchStarfall() {
    for (let i = 0; i < 20; i++) {
        setTimeout(() => {
            const star = document.createElement('div');
            star.textContent = '‚≠ê';
            star.style.cssText = `
                position: fixed; left: ${Math.random() * 100}vw; top: -30px;
                font-size: ${15 + Math.random() * 20}px; pointer-events: none;
                z-index: 9998;
            `;
            document.body.appendChild(star);
            
            star.animate([
                { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                { transform: `translateY(110vh) rotate(${Math.random() * 360}deg)`, opacity: 0 }
            ], { 
                duration: 2000 + Math.random() * 1000,
                easing: 'ease-in'
            }).onfinish = () => star.remove();
        }, i * 150);
    }
}

function launchBalloons() {
    const balloons = ['üéà', 'üéà', 'üéà'];
    
    for (let i = 0; i < 15; i++) {
        setTimeout(() => {
            const balloon = document.createElement('div');
            balloon.textContent = balloons[Math.floor(Math.random() * balloons.length)];
            balloon.style.cssText = `
                position: fixed; left: ${Math.random() * 100}vw; bottom: -50px;
                font-size: ${25 + Math.random() * 20}px; pointer-events: none;
                z-index: 9998; filter: hue-rotate(${Math.random() * 360}deg);
            `;
            document.body.appendChild(balloon);
            
            balloon.animate([
                { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                { transform: `translateY(-120vh) translateX(${(Math.random()-0.5)*100}px) rotate(${Math.random() * 360}deg)`, opacity: 0.5 }
            ], {
                duration: 4000 + Math.random() * 2000,
                easing: 'ease-out'
            }).onfinish = () => balloon.remove();
        }, i * 200);
    }
}

// ============================================
// –ó–ê–ì–†–£–ó–ö–ê –ò –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø –ü–†–û–ì–†–ï–°–°–ê
// ============================================

// –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–∞—Å—Å–∏–≤–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
db.ref('decorations').once('value', (snapshot) => {
    const data = snapshot.val() || {};
    
    const passiveConfigs = {
        'tree': { max: 100, activate: activateTreeDecoration },
        'garland': { max: 150, activate: activateGarlandDecoration },
        'snow': { max: 200, activate: activateSnowDecoration },
        'corners': { max: 120, activate: activateCornerSnow },
        'header-garland': { max: 180, activate: activateHeaderGarland },
        'stars': { max: 140, activate: activateSideStars },
        'border': { max: 160, activate: activateFestiveBorder },
        'ambient-confetti': { max: 220, activate: activateAmbientConfetti },
        'side-lights': { max: 190, activate: activateSideLights },
        'timer-snow': { max: 170, activate: activateTimerSnow }
    };
    
    Object.keys(passiveConfigs).forEach(type => {
        const config = passiveConfigs[type];
        const count = data[type] || 0;
        
        if (count >= config.max) {
            config.activate();
            const slot = document.getElementById('slot-' + type);
            if (slot) slot.classList.add('completed');
        }
        
        const countEl = document.getElementById(type + '-count');
        if (countEl) countEl.textContent = `${count}/${config.max}`;
        
        const bar = document.getElementById('bar-' + type);
        if (bar) bar.style.width = Math.min(100, (count / config.max) * 100) + '%';
    });
});

// –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –º–Ω–æ–≥–æ—Ä–∞–∑–æ–≤—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
db.ref('multi_use').once('value', (snapshot) => {
    const data = snapshot.val() || {};
    
    const multiConfigs = {
        'firework': 30,
        'gifts': 25,
        'confetti': 20,
        'lightning': 35,
        'starfall': 28,
        'balloons': 22
    };
    
    Object.keys(multiConfigs).forEach(type => {
        const max = multiConfigs[type];
        const count = data[type] || 0;
        
        const countEl = document.getElementById(type + '-ready');
        if (countEl) countEl.textContent = `${count}/${max}`;
        
        const bar = document.getElementById('bar-' + type + '-ready');
        if (bar) bar.style.width = Math.min(100, (count / max) * 100) + '%';
    });
});

// –°–ª—É—à–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Å—Å–∏–≤–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
db.ref('decorations').on('value', (snapshot) => {
    const data = snapshot.val() || {};
    
    if (data.tree >= 100 && !document.querySelector('.header-tree')) {
        activateTreeDecoration();
    }
    if (data.garland >= 150) {
        activateGarlandDecoration();
    }
    if (data.snow >= 200 && document.querySelectorAll('.permanent-snow').length === 0) {
        activateSnowDecoration();
    }
    if (data.corners >= 120 && !document.querySelector('.corner-snow')) {
        activateCornerSnow();
    }
    if (data['header-garland'] >= 180 && !document.querySelector('.header-garland')) {
        activateHeaderGarland();
    }
    if (data.stars >= 140 && !document.querySelector('.side-star')) {
        activateSideStars();
    }
    if (data.border >= 160 && !document.querySelector('.festive-border')) {
        activateFestiveBorder();
    }
    if (data['ambient-confetti'] >= 220 && document.querySelectorAll('.ambient-confetti').length === 0) {
        activateAmbientConfetti();
    }
    if (data['side-lights'] >= 190 && !document.querySelector('.side-light')) {
        activateSideLights();
    }
    if (data['timer-snow'] >= 170) {
        activateTimerSnow();
    }
});

// –°–ª—É—à–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–Ω–æ–≥–æ—Ä–∞–∑–æ–≤—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
db.ref('multi_use').on('value', (snapshot) => {
    const data = snapshot.val() || {};
    
    const multiConfigs = {
        'firework': { max: 30, launch: launchFirework },
        'gifts': { max: 25, launch: launchGiftRain },
        'confetti': { max: 20, launch: launchConfetti },
        'lightning': { max: 35, launch: launchLightning },
        'starfall': { max: 28, launch: launchStarfall },
        'balloons': { max: 22, launch: launchBalloons }
    };
    
    Object.keys(multiConfigs).forEach(type => {
        const config = multiConfigs[type];
        const count = data[type] || 0;
        
        const countEl = document.getElementById(type + '-ready');
        if (countEl) countEl.textContent = `${count}/${config.max}`;
        
        const bar = document.getElementById('bar-' + type + '-ready');
        if (bar) bar.style.width = Math.min(100, (count / config.max) * 100) + '%';
        
        if (count >= config.max) {
            config.launch();
        }
    });
});

function resetAllProgress() {
    if (!confirm('–¢–û–ß–ù–û –°–ë–†–û–°–ò–¢–¨ –í–ï–°–¨ –ü–†–û–ì–†–ï–°–°?')) return;
    
    db.ref('decorations').set({});
    db.ref('multi_use').set({});
    db.ref('global_progress').set(0);
    db.ref('live_clicks').remove();
    
    alert('–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–±—Ä–æ—à–µ–Ω');
}
</script>
<div id="music-notice" class="music-notice">
  <div class="disc-wrapper">
    <div class="disc">üíø</div>
  </div>
  <div class="track-info">
    <div class="track-label">–°–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç</div>
    <div id="track-name" class="track-title">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞</div>
  </div>
</div>


</body>
</html>
